(function(n){n.fn.levelGrid=function(t){var i=this,u=this.selector,r;return i.searchParams={keyword:"",limit:null},i.editParams={},i.sourceData=[],i.viewData=[],i.count=0,i.rowIndex=0,i.sequentially={number:20,total:0,first:!1,done:!1,loading:!1,loaded:0},i.aiAlpha=["","A","B","C","D","E","F","G","H","I"," J","K"],i.formId="",i.sumarray=[],i.tounchTr=null,i.moveObjectId=null,i.colRight,i.searching,i.initData=!1,i.hr=31,i.editLoader=".salary-grid-edit-loader",i.clickSubContextMenu=!1,r=n.extend({tableSize:null,lazy:null,rootUrl:null,dataUrl:null,params:null,autoLoad:null,width:null,height:null,selectRow:null,toolbars:null,idAttribute:null,rows:[],cols:null,editController:null,model:"",filterable:!1,checkAll:null,beforeSubmit:null,detailRow:null,childs:null,modal:null,contextMenu:null,skipCols:0,loadDataCallback:null,loadModalCallback:null,selectRowCallback:null,submitFormCallback:null,sumInfo:null,beforeSearch:null,hideable:!1},t),i.set=r,r.paging!=null&&(i.searchParams.page=r.paging.page!=null?r.paging.page:1,i.searchParams.limit=r.paging.limit!=null?r.paging.limit:20),i.filter={attrs:[]},r.params!=null&&(typeof r.params.search!="undefined"&&n.extend(i.searchParams,r.params.search),typeof r.params.edit!="undefined"&&n.extend(i.editParams,r.params.edit)),i.showTableLoading=function(){var t=n(u).find(".main-content");n(t).find(".loading").length==0&&n(t).append(app.loading());n(u).find(".loading").show()},i.hideTableLoading=function(){n(u).find(".loading").hide()},i.drawCheckbox=function(n){return'<td class="first-col" style="width: 40px"><div class="checkbox checkbox-info"><input type="checkbox"  class="styled check-item" value="" dataId="'+n+'"/><label><\/label><\/div><\/td>'},i.drawExpandNode=function(n,t){var i='<button type="button" class="btn btn-icon btn-xs btn-expander expand-child '+(t==0?"not-child":"")+'" level="'+n+'">';return i+=r.expand>=n?'<i class="icon-arrow-down5"><\/i>':'<i class="icon-arrow-right5"><\/i>',i+"<\/button>"},i.setTdData=function(t,r,u,f,e){var o='<td data-attr="'+r.attribute+'" ci="'+u+'"',y="",l="",v,p,w,k,s,h,b,c,a,d;r.class!=null&&(y+=n.isFunction(r.class)?" "+r.class(t)+" ":" "+r.class+" ");r.editInline&&(y+=" edit-inline ");e==1&&(y+="  text-bold ");o+=' class="'+y+'"';o+=' style=" ';v="";r.style!=null&&(v+=n.isFunction(r.style)?" "+r.style(t)+" ":r.style);o+=v+'"';r.colspan!=null&&r.colspan.if(t)&&(o+=' colspan="'+r.colspan.value+'" ');switch(r.type){case"text":if(r.sumable?typeof i.sumarray[u]=="undefined"&&(i.sumarray[u]=0):i.sumarray[u]=null,o+=">",o+="<div>",r.expandChild!=null&&(o+=i.drawExpandNode(e,t.Childs!=null?t.Childs.length:0)),s="",r.attribute!=null&&t[r.attribute]!=null&&(s=t[r.attribute]),r.editInline!=null)if(p=r.editInline,p==!0)o+='<span class="span-edit-inline ell" >'+s+"<\/span>",o+='<div class="form-group inline-form"><input style="'+v+'" class="form-control" data-type="text" attr="'+r.attribute+'" value="'+s+'" /><\/div>';else switch(p.type){case"option":w='<select style="'+v+'" class="form-control" data-type="text" attr="'+r.attribute+'" >';n(p.lst).each(function(){w+='<option value="'+this.id+'" '+(s==this.id?'selected="selected"':"")+">"+this.text+"<\/option>";this.id==s&&(l=this.text)});w+="<\/select>";o+='<span class="span-edit-inline" >'+s+"<\/span>";o+='<div class="form-group inline-form">'+w+"<\/div>";break;case"remote":k='<div class="input-group input-group-sm"><input type="text" attr="'+r.attribute+'" class="form-control select-inline-remote" data-index="'+u+'" data-width="250px" />';k+="<\/div>";o+=r.render!=null?'<span class="span-edit-inline">'+r.render(t)+"<\/span>":'<span class="span-edit-inline">'+s+"<\/span>";o+='<div class="form-group inline-form">'+k+"<\/div>"}else r.render!=null?o+='<span class=""> '+r.render(t)+"<\/span>":(o+="<span ",r.aline!=null&&(o+=' class="aline" title="'+s+'"'),o+="> "+s+"<\/span>");o+="<\/div>";break;case"checkbox":o+=">";s=t[r.attribute];o+='<div class="form-group"><input class="" type="checkbox" attr="'+r.attribute+'" value="true" '+(s==!0?'checked="checked"':"")+" /><\/div>";i.sumarray[u]=null;break;case"option":for(o+=' style="width: 40px;">',h='<ul class="icons-list">',h+='<li class="dropdown">',h+='<a class="dropdown-toggle" href="#" data-toggle="dropdown" aria-expanded="false"><i class="icon-menu9" style="font-size: 16px;"><\/i><\/a>',h+='<ul class="dropdown-menu dropdown-menu-right" style="width: 200px">',b=0;b<r.render.length;b++)c=r.render[b],c!=null&&(c.condition==null||c.condition(t))&&(h+='<li><a href="javascript:void(0)"',c.class!=null&&(h+='class="'+c.class+'"'),h+='><i style="margin-right:5px" class="'+c.icon+" "+c.iconColor+'"><\/i>'+c.text+"<\/a><\/li>");h+="<\/li><\/ul>";o+=h+"<\/ul>";break;case"date":o+=">";o+="<span>"+app.formatDate(t[r.attribute])+"<\/span>";i.sumarray[u]=null;break;case"time":o+=">";o+=app.formatTime(t[r.attribute]);i.sumarray[u]=null;break;case"datetime":o+=">";o+=app.formatDateTime(t[r.attribute]);i.sumarray[u]=null;break;case"html":o+=">";r.render!=null?o+=r.render(t).replace(/\n/g,"<br/>"):r.attribute!=null&&(o+=t[r.attribute]!=null?t[r.attribute]:"");i.sumarray[u]=null;break;case"price":case"number":r.sumable&&typeof i.sumarray[u]=="undefined"&&(i.sumarray[u]=0);a=0;a=r.render!=null?r.render(t,r.attribute):parseFloat(t[r.attribute]);o+=' data-val="'+a+'"';o+=">";i.sumarray[u]+=a;l=r.fixed!=null?a.toFixed(r.fixed):Math.round(a);l=r.renderText!=null?r.renderText(t):r.type=="price"?app.formatPrice(l):l;o+="<div>";r.editInline?(o+='<span class="span-edit-inline"> '+l+"<\/span>",d=r.style!=null?r.style:"",o+='<div class="form-group inline-form"><input style="'+d+'" class="form-control" data-type="price" attr="'+r.attribute+'" value="'+a+'" /><\/div>'):o+='<span class=""> '+l+"<\/span>";o+="<\/div>";break;case"ai":o+=">";o+=f;r.sumable?(typeof i.sumarray[u]=="undefined"&&(i.sumarray[u]=0),i.sumarray[u]+=1):i.sumarray[u]=null}return o+"<\/td>"},i.drawRow=function(n,t,u,f,e,o){var w={left:"",right:""},l=r.skipCols,s='<tr data-level="'+f+'" ',a,v,y,p,h,c;if(r.contextMenu!=null&&(s+=' data-toggle="context" data-target=".context-table-row" '),s+=' dataid="'+n[t]+'" dataParentId="'+(n.ParentId!=null?n.ParentId+"":"")+'"  ai="'+u+'" gid="'+e+'" '+(o!=null?'parentId="'+o+'"':""),a=' class="tr-child tr-real level-'+f+" ",r.expand>=f&&n.Childs!=null&&(a+=" expanded "),r.rowStyle!=null&&(s+=" "+r.rowStyle(n)+'" '),a+='"',r.expand<f-1&&(s+=' style="display: none" '),s+=a,typeof n.Code!="undefined"&&(s+=' datacode="'+n.Code+'" '),n.ParentId!=null&&(s+=' parent="'+n.ParentId+'" '),s+=">",l>0){for(c="",l>0&&(r.checkAll==null||r.checkAll)&&(c+=i.drawCheckbox(n.Id),l--),v=0,y=l,h=v;h<y;h++)p=r.rows[h],c+=i.setTdData(n,p,h,u,f);w.left=s+c+"<td>&nbsp;<\/td><\/tr>"}for(c="",v=l,y=r.rows.length,h=v;h<y;h++)p=r.rows[h],c+=i.setTdData(n,p,h,u,f);return w.right=s+c+"<td>&nbsp;<\/td><\/tr>",w},i.drawRowWithoutTr=function(n,t,u){var l={left:"",right:""},o=r.skipCols,a="",s,h,c,f,e;if(o>0){for(e="",o>0&&(r.checkAll==null||r.checkAll)&&(e+=i.drawCheckbox(n.Id),o--),s=0,h=o,f=s;f<h;f++)c=r.rows[f],e+=i.setTdData(n,c,f,t,u);l.left=a+e+"<td>&nbsp;<\/td>"}for(e="",s=o,h=r.rows.length,f=s;f<h;f++)c=r.rows[f],e+=i.setTdData(n,c,f,t,u);return l.right=a+e+"<td>&nbsp;<\/td>",l},i.drawGroup=function(t,u,f,e){var c=r.skipCols,k=n(".area-bl table tbody"),d=n(".area-br table tbody"),g=r.group,o='<tr dataid="'+t.Id+'" class="tr-group '+(r.expand>0?"expanded":"")+' level-1 " gid="'+e+'" ',v,y,w,l,h,a,s,p,b;if(r.contextMenu!=null&&(o+=' data-toggle="context" data-target=".context-table-row" '),o+=" > ",c>0){for(c>0&&(r.checkAll==null||r.checkAll)&&(o+='<td class="" style=""><div class="checkbox"><input type="checkbox" class="styled check-group" gid="'+e+'" /><label><\/label><\/div><\/td>',c--),v=0,y=c,l=v;l<y;l++)w=r.rows[l],o+=i.setTdData(t,w,l,f,1);o+="<td>&nbsp;<\/td><\/tr>"}for(g.addable&&(o+='<button class="btn btn-icon btn-xs btn-add-row bg-primary" groupid="'+t.Id+'" type="button"><i class="icon-plus3"><\/i><\/button>'),o+="<\/div><\/td><\/tr>",k.append(o),o="",v=c,y=r.rows.length,h='<tr dataid="'+t.Id+'" class="tr-group '+(r.expand>0?"expanded":"")+' level-1 " gid="'+e+'" ',r.contextMenu!=null&&(h+=' data-toggle="context" data-target=".context-table-row" '),h+=" >",console.log(h),a=v;a<y;a++)s=r.rows[a],p=s.style!=null?s.style:"",p+="",b=t[s.attribute]!=null?t[s.attribute]:"",h+=s.sumable?'<td data-attr="'+s.attribute+'" class="text-bold text-right " style="'+p+'"><span>'+app.formatPrice(b)+"<\/span><\/td>":i.setTdData(t,s,a,f);return h+="<td>&nbsp;<\/td><\/tr>",o+=h,d.append(o),null},i.drawAddInline=function(n,t,i){var h={left:"",right:""},e=2,l='<tr  groupid="'+n.Id+'" class="tr-child tr-add-inline" >',o,s,c,f,u;if(e>0){for(u="",e>0&&(r.checkAll==null||r.checkAll)&&(u+="<td>&nbsp;<\/td>",e--),o=0,s=e,f=o;f<s;f++)c=r.rows[f],c.addInline?(u+='<td class="add-inline">',u+='<span class="span-add-inline pl-30" ><i class="icon-plus3 position-left"><\/i>Thêm mới<\/span>',u+='<div class="form-group inline-form"><input style="" stt="'+i+'" class="form-control pl-20" data-type="text" attr="'+c.attribute+'" value="" /><\/div>',u+="<\/td>"):u+="<td>&nbsp;<\/td>";h.left=l+u+"<td>&nbsp;<\/td><\/tr>"}for(u="",o=e,s=r.rows.length,f=o;f<s;f++)u+="<td>&nbsp;<\/td>";return h.right=l+u+"<td>&nbsp;<\/td><\/tr>",h},i.drawSuminfo=function(n){var t=i.set.sumInfo,f,o,h,c,u,e,l,s;for(r.skipCols>0&&n.find(".area-bl tbody").append('<tr class="warning tr-total"><td colspan="'+r.skipCols+'" style="height: 31px" class="text-bold text-center">TỔNG CỘNG<\/td><\/tr>'),f='<tr class="warning tr-total">',o=0,t.colspan!=null&&(o=t.colspan,f+='<td colspan="'+t.colspan+'" style="text-align: right"><strong>Tổng<\/strong><\/td>'),r.skipCols>0&&(o+=r.skipCols),h=-1,c="",t.label!=null&&(h=t.label.col!=null?t.label.col:0,c=t.label.text!=null?t.label.text:"TỔNG CỘNG"),u=o;u<i.set.rows.length;u++)u==h?f+='<td style="text-align: right"><strong>'+c+"<\/strong><\/td>":(e=i.set.rows[u],e.sumable?(l="",i.sumarray.length>u&&(l=e.fixed!=null?i.sumarray[u].toFixed(e.fixed):app.formatPrice(i.sumarray[u])),s='<td class="text-right" data-attr="'+e.attribute+'" ',e.style!=null&&(s+='style="'+e.style+'"'),s+=" ><strong>"+l+"<\/strong><\/td>",f+=s):f+="<td>&nbsp;<\/td>");f+="<td><\/td><\/tr>";n.find(".area-br tbody").append(f)},i.rowFilter=function(t){var o=r.skipCols,h='<tr class="tr-filter">',c,l,f,u,v,y,e,s,a,p,i;if(t){if(o==0)return"";o>0&&(r.checkAll==null||r.checkAll)&&(h+="<td><\/td>",o--);c=0;l=o}else(r.checkAll==null||r.checkAll)&&(o==0?h+="<td><\/td>":o--),c=o,l=r.rows.length;for(f=c;f<l;f++)if(u=r.rows[f],v=app.hasValue(u.visible)?u.visible():!0,v){if(y=r.model,u.model!=null&&(y=u.model),e="<td ",u.colspan!=null&&u.colspan.if(item)&&(e+=' colspan="'+u.colspan.value+'" '),e+=">",s=u.filter,s!=null)switch(s.type){case"contains":i='<div class="input-group input-group-sm"><div class="input-group-btn" > <button type="button" class="btn btn-default btn-left dropdown-toggle" title="Lộc dữ liệu" data-toggle="dropdown"><i class="icon-search4"><\/i><\/button><\/div > <input type="text" class="form-control filter-contains" data-index="'+f+'" attr="'+s.attr+'" placeholder="..."><\/div>';e+=i;break;case"option":a=r.head.groups[f];i='<div class="form-group form-group-sm"><div class="input-group input-group-sm"><select class="form-control filter-option select-option" attr="'+u.attribute+'"  data-index="'+f+'" data-width="'+a+'" style="width: '+a+'px"><option value="">Tất cả<\/option>';s.lst!=null&&(p=s.lst(),n(p).each(function(){i+='<option value="'+this.id+'">'+this.text+"<\/option>"}));i+="<\/select><\/div><\/div>";e+=i;break;case"optionRemote":i='<div class="form-group form-group-sm"><div class="input-group input-group-sm"><div class="input-group-btn" > <button type="button" class="btn btn-default btn-left dropdown-toggle" title="Lộc dữ liệu" data-toggle="dropdown"><i class="icon-filter4"><\/i><\/button><\/div><input type="text" attr="'+u.attribute+'" class="form-control filter-option select-option-remote" data-index="'+f+'" data-width="'+r.head.groups[f]+'"/>';i+="<\/div><\/div>";e+=i;break;case"compoTree":i='<div class="form-group form-group-sm"><div class="input-group input-group-sm"><div class="input-group-btn" > <button type="button" class="btn btn-default btn-left dropdown-toggle" title="Lộc dữ liệu" data-toggle="dropdown"><i class="icon-filter4"><\/i><\/button><\/div>';i+='<input class="form-control compo-tree" id="'+app.newGuid()+'" data-index="'+f+'" type="text" />';i+="<\/div><\/div>";e+=i;break;case"date":i='<div class="datepicker" from to name="'+u.attribute+'" data-index="'+f+'" ><\/div>';e+=i}e+="<\/td>";h+=e}return h+"<td>&nbsp;<\/td><\/tr>"},i.drawEmptyRow=function(n){var t=r.skipCols,u='<tr class="empty">',f;if(n){if(t==0)return"";t>0&&(r.checkAll==null||r.checkAll)&&(u+=i.drawCheckbox(),t--);f=t}else(r.checkAll==null||r.checkAll)&&(t==0?u+=i.drawCheckbox():t--),f=r.rows.length-t;return u+='<td colspan="'+f+'"><\/td>',u+"<td>&nbsp;<\/td><\/tr>"},i.drawChilds=function(t,r,u,f){var o,s,h,e={l:"",r:""};return n(f).each(function(n,f){if(s=app.newGuid(),h=t+"."+(n+1),o=i.drawRow(f,"Id",h,u,s,r),e.l+=o.left,e.r+=o.right,f.Childs!=null){var c=i.drawChilds(h,s,u+1,f.Childs);e.l+=c.l;e.r+=c.r}}),e},i.setViewData=function(t){var e="Id",f,u,o,s;r.idAttribute!=null&&(e=r.idAttribute);o=n(".area-bl table tbody");s=n(".area-br table tbody");n.each(t,function(t,h){var l,a,c;u=app.newGuid();f=r.group.aiAlpha?i.aiAlpha[t+1]:t+1;i.drawGroup(h,e,f,u);l=o.find('.tr-group[gid="'+u+'"]');a=s.find('.tr-group[gid="'+u+'"]');h.Childs!=null&&(c=i.drawChilds(f,u,2,h.Childs),n(l).after(c.l),n(a).after(c.r))})},i.loadData=function(t,f,e){t!=null&&n.extend(i.searchParams,t);app.cleanJson(i.searchParams);i.showTableLoading();n.ajax({url:r.url,type:"GET",dataType:"JSON",contentType:"application/json; charset=utf-8",data:i.searchParams,success:function(t){var s=t.Many,l=r.optionMenu!=null,o=n(u).find("> .level-table > .main-content"),h,c;o.find(".area-bl tbody").html("");o.find(".area-br tbody").html("");o.find(".area-bom tbody").html("");i.sourceData=s;h=t.Count!=null?t.Count:0;i.count=h;i.sumarray=[];r.rows.length>0&&(s!=null&&s.length>0?(i.setViewData(s),setTimeout(function(){i.setRowEvents()},400),r.loadDataCallback!=null&&r.loadDataCallback(),i.set.sumInfo!=null&&(i.drawSuminfo(o),i.updateTotalRow()),o.find(".empty-message").css("display","none")):(c=i.drawEmptyRow(!0),o.find(".area-bl tbody").append(c),c=i.drawEmptyRow(!1),o.find(".area-br tbody").append(c),o.find(".empty-message").css("display","block")));o.find(" .total-row span").text(h);r.paging!=null&&(o.find("tfoot").css("display",""),i.setPagination(h));i.hideTableLoading();r.loadDataCallback!=null&&r.loadDataCallback(t,e);f!=null&&f(t)}})},i.searchGroup=function(n){i.filter.groupId=n!=null&&n.length>0?parseInt(n):null;i.search(null)},i.search=function(t,f){var c,s,l,h,e,o;if(r.filterReload){for(c={},s=0;s<i.filter.attrs.length;s++)l=i.filter.attrs[s],c[l.attr]=l.v;i.searchParams.page=1;n.extend(i.searchParams,c);i.loadData(null,f)}else t!=null&&n.extend(i.filter,t),h=n(u).find("> .level-table > .main-content"),h.find(".area tbody tr.tr-add-inline").css("display","none"),e=h.find(" .area-bl tbody"),e.find("tr.tr-group").css("display","none"),o=h.find(" .area-br tbody"),o.find("tr.tr-group").css("display","none"),i.showTableLoading(),setTimeout(function(){n(i.sourceData).each(function(){var t=this,r=0;n(t.Childs).each(function(){for(var n,u=!0,t=this,f=0;f<i.filter.attrs.length;f++){n=i.filter.attrs[f];switch(n.type){case"option":n.v!=null&&t[n.attr]+""!=n.v&&(u=!1);break;case"contains":n.v!=null&&n.v.length>0&&(t.Keyword!=null?t.Keyword.indexOf(n.v)<0&&(u=!1):u=!1)}}u?(r++,e.find('tr.tr-child[dataid="'+t.Id+'"]').css("display","table-row"),o.find('tr.tr-child[dataid="'+t.Id+'"]').css("display","table-row")):(e.find('tr.tr-child[dataid="'+t.Id+'"]').css("display","none"),o.find('tr.tr-child[dataid="'+t.Id+'"]').css("display","none"))});r>0&&(e.find('tr.tr-group[groupid="'+t.Id+'"]').css("display","table-row"),o.find('tr.tr-group[groupid="'+t.Id+'"]').css("display","table-row"))});i.hideTableLoading()},300)},i.setData=function(t,f){var o=t.Count!=null?t.Count:0,e=t.Many!=null?t.Many:t.length>0?t:null,s;e!=null&&(o==0&&(o=e.length),n(u).find(".area-bl tbody").html(""),n(u).find(".area-br tbody").html(""),i.sourceData=e);i.count=o;r.rows.length>0&&e!=null&&e.length>0&&(s="Id",r.idAttribute!=null&&(s=r.idAttribute),i.sumarray=[],n.each(e,function(t,r){var f=i.drawRow(r,s,1,t+1,!0);n(u).find(".area-bl tbody").append(f);f=i.drawRow(r,s,1,t+1,!1);n(u).find(".area-br tbody").append(f)}));n(u).find(".main-content .total-row span").text(o);i.hideTableLoading();i.setRowEvents();r.loadDataCallback!=null&&r.loadDataCallback(t);f!=null&&f(t)},i.setSubmitEvent=function(n){var t=!0;if(r.beforeSubmit!=null&&(t=r.beforeSubmit()),!t||!r.autoSubmit)return!1;i.submitForm(n)},i.hideModal=function(){var t=parseInt(n("#"+r.model+"FormEditModal").attr("data-type"));t==2?n("#"+r.model+"FormEditModal").fadeOut("fast",function(){n("#"+r.model+"FormEditModal").remove()}):n("#"+r.model+"FormEditModal").modal("hide");n("body").removeClass("overflow-hidden")},i.eventModal=function(){var u;n(".form-cancel").unbind().click(function(){i.hideModal()});var t=n(window).height(),f="#formEditModal",e=n(f+" form").height();e+=117;u=(t-e)/4;t<e&&(u=0,e=t);n(f+" .wtable-epanel-content").css("height",e+"px").css("top",u+"px");n(window).resize(function(){var h=r.modal,s,i,o,e;h.type==2&&(s=n(window).width(),t=n(window).height(),i=h.width,o="",i.indexOf("%")>-1?(i=i.substr(0,i.length-1),o=(100-parseInt(i))/2+"%"):i.indexOf("px")>-1&&(i=i.substr(0,i.length-2),i=parseInt(i),o=s>i?(s-i)/2+"px":"0px"),e=n(f+" form").height(),e+=117,u=(t-e)/4,t<e&&(u=0,e=t),n(f+" .wtable-epanel-content").css("left",o).css("height",e+"px").css("top",u+"px"))});n(f).on("keyup keypress",function(n){var t=n.keyCode||n.which;if(t===13)return n.preventDefault(),!1})},i.initModal=function(t,i){var u="";if(t.type==2){var o=n(window).width(),f=t.width,e="";f.indexOf("%")>-1?(f=f.substr(0,f.length-1),e=(100-parseInt(f))/2+"%"):f.indexOf("px")>-1&&(f=f.substr(0,f.length-2),f=parseInt(f),o>f&&(e=(o-f)/2+"px"));u='<div class="wtable-epanel" id="'+r.model+'FormEditModal" data-type="'+t.type+'">';u+=t.width!=""?'<div class="wtable-epanel-content" style="width:'+t.width+";left: "+e+'">':'<div class="wtable-epanel-content">';u+='<div class="panel panel-flat wtable-panel">';u+=i;u+="<\/div><\/div><\/div>";n("body").append(u)}else{if(u='<div class="modal" id="'+r.model+'FormEditModal" data-type="'+t.type+'" data-backdrop="static"  role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">',u+=t.width!=""?'    <div class="modal-dialog" style="width:'+t.width+'">':'    <div class="modal-dialog" >',u+='<div class="modal-content">',u+='      <div class="modal-header p-15 '+(t.headerClass!=null?t.headerClass:"")+'">',u+='          <button class="close" aria-hidden="true" data-dismiss="modal" type="button">×<\/button>',u+='              <h5 class="modal-title text-bold">'+t.title+"<\/h5>",u+='          <\/div><form id="'+r.model+'Form" class="form-horizontal"><div class="modal-body '+(t.noPaddingBody!=null?"no-padding":"pt-15 pl-15 pr-15 pb-5")+'">',u+=i,u+="<\/div>",t.footerTemplate!=null)u+=n(t.footerTemplate).html();else switch(t.mode){case 2:u+='<div class="panel-footer panel-footer p-15"><div class="pull-right"><button class="btn btn-sm btn-default form-cancel mr-10 btn-rounded" data-dismiss="modal"><i class="fa fa-remove"><\/i> Thoát<\/button><button class="btn btn-sm bg-slate mr-10 btn-submit btn-rounded" type="button" data-mode="1" data-loading-text="<i class=\'icon-spinner4 fa-spin position-left\'><\/i> Lưu tạm"><i class="icon-floppy-disk position-left"><\/i> Lưu tạm<\/button><button class="btn btn-sm btn-success btn-submit btn-rounded" type="button" data-mode="2" data-loading-text="<i class=\'icon-spinner4 fa-spin position-left\'><\/i> Lưu và gửi đề xuất"><i class="icon-paperplane position-left"><\/i> Lưu và gửi đề xuất<\/button><\/div><\/div>';break;case 3:u+='<div class="panel-footer panel-footer p-15"><div class="pull-right"><button class="btn btn-sm btn-default form-cancel mr-10 btn-rounded" data-dismiss="modal"><i class="fa fa-remove"><\/i> Thoát<\/button><button class="btn btn-sm bg-slate mr-10 btn-submit btn-rounded" type="button" data-mode="1" data-loading-text="<i class=\'icon-spinner4 fa-spin position-left\'><\/i> Lưu tạm"><i class="icon-floppy-disk position-left"><\/i> Lưu tạm<\/button><button class="btn btn-sm btn-success btn-submit btn-rounded" type="button" data-mode="3" data-loading-text="<i class=\'icon-spinner4 fa-spin position-left\'><\/i> Lưu và gửi đề xuất"><i class="icon-check position-left"><\/i> Lưu và ký chốt<\/button><\/div><\/div>';break;default:u+='<div class="panel-footer panel-footer p-15"><div class="pull-right"><button class="btn btn-sm btn-default form-cancel mr-10 btn-rounded" data-dismiss="modal"><i class="fa fa-remove"><\/i> Thoát<\/button><button class="btn btn-sm btn-fill btn-primary m-r-5 btn-submit btn-rounded" type="button" data-loading-text="<i class=\'icon-spinner4 fa-spin\'><\/i> Đang xử lý ..."><i class="fa fa-save"><\/i> Lưu lại<\/button><\/div><\/div>'}u+="<\/form><\/div><\/div><\/div>";n("body").append(u);n("#"+r.model+"FormEditModal").on("hidden.bs.modal",function(){n("body").removeClass("overflow-hidden");n("#"+r.model+"FormEditModal").remove()})}},i.showModal=function(){var t=parseInt(n("#"+r.model+"FormEditModal").attr("data-type"));t==2?n("#"+r.model+"FormEditModal").fadeIn("fast"):n("#"+r.model+"FormEditModal").modal("show");n("body").addClass("overflow-hidden")},i.createOrUpdateObject=function(t,u,f){i.showTableLoading();var e=r.editController!=null?r.editController+"/":"/admin/";e+=r.model+"Edit";n.extend(i.editParams,t);n.ajax({url:e,type:"GET",data:i.editParams,dataType:"html",success:function(n){i.hideTableLoading();var e=r.modal;i.initModal({title:(t.id>0?"Cập nhật ":"Thêm mới ")+e.title,width:e.width,type:e.type!=null?e.type:1,noPaddingBody:e.noPaddingBody,headerClass:e.headerClass,noFooter:e.noFooter,mode:e.mode},n);i.eventModal();i.showModal();r.loadModalCallback!=null&&r.loadModalCallback(f);u&&u()}})},i.getSelectedIds=function(){var t=[];return n.each(n(u).find("> .level-table > .main-content .area-br tr"),function(i,r){n(r).hasClass("active")&&t.push(n(r).attr("dataid"))}),t},i.getCheckedRowIds=function(){var t=[];return n.each(n(u).find('> .level-table > .main-content .first-col input[type="checkbox"]'),function(){n(this).prop("checked")==!0&&t.push(n(this).closest("tr").attr("dataid"))}),t},i.getCheckedDatas=function(){var u=[],e="Id",t,n,f;for(r.idAttribute!=null&&(e=r.idAttribute),t=i.getCheckedRowIds(),n=0;n<t.length;n++)f=i.getDataById(t[n],null),u.push(f);return u},i.setCheckedRowIds=function(t){for(var r,f,e=n(u).find("> .level-table > .main-content"),i=0;i<t.length;i++)r=e.find('.area-bl tr[dataid="'+t[i]+'"]'),f=n(r).find('.first-col input[type="checkbox"]'),f.prop("checked",!0);n.uniform.update()},i.getSelectedRow=function(){return n(u).find('> .level-table > .main-content .area-br tr[class="active"]').first()},i.getSelectedDatas=function(){var f=[],e="Id",u,t;for(r.idAttribute!=null&&(e=r.idAttribute),u=i.getSelectedIds(),t=0;t<u.length;t++)n(i.sourceData).each(function(){if(this[e]==u[t])return f.push(this),!1});return f},i.addChild=function(t,u){var e,f;i.showTableLoading();e=r.editController!=null?r.editController+"/":"/admin/";e+=r.model+"Edit";f=r.modal;n.ajax({url:e,type:"GET",data:t,dataType:"html",success:function(n){i.hideTableLoading();i.initModal({title:"Thêm "+f.title.toLowerCase(),width:f.width,type:f.type!=null?f.type:1,mode:f.mode},n);i.eventModal();i.showModal();r.loadModalCallback!=null&&r.loadModalCallback(u)}})},i.getDataById=function(n,t){var u,f,r;for(t==null&&(t=i.sourceData),f=0;f<t.length;f++)if(r=t[f],r.Id==n){u=r;break}else if(r.Childs!=null&&(u=i.getDataById(n,r.Childs),u!=null))break;return u},i.getActiveTabIndex=function(){return n(u).find("> .level-table > .sub-content > .tab-content > div.active").index()},i.loadFilterOption=function(t,i){var f,u,e;if(!n(t).hasClass("loaded")&&(f=t.attr("data-index"),u=r.rows[f].filter,u.ajax!=null))return e=u.ajax.data,app.loadData(u.ajax.url,e,null,function(r){t.addClass("loaded");var f=r.Many!=null?r.Many:r;n(f).each(function(){var n=new Option(this[u.ajax.attr.text],this[u.ajax.attr.id],!0,!0);t.append(n)});t.select2("val","");i!=null&&i()}),!0},i.setStaticEvents=function(){var t,s,f,e,o;if(i.resize(),n(window).resize(function(){i.resize()}),t=n(u).find("> .level-table > .main-content"),s=n("#sub_content_modal"),window.addEventListener("touchstart",function(t){i.tounchTr=n(t.target).closest(".area")}),n(t).find(" .area").mouseover(function(){i.tounchTr=n(this)}),t.find(".area-tr > div").scroll(function(){if(n(i.tounchTr).length==0||n(i.tounchTr).hasClass("area-tr")){var r=n(this).scrollLeft();t.find(".area-br > div").scrollLeft(r)}}),t.find(".area-br > div").scroll(function(){if(n(i.tounchTr).length==0||n(i.tounchTr).hasClass("area-br")){clearTimeout(n.data(this,"scrollCheck"));var r=n(this).scrollTop(),u=n(this).scrollLeft();t.find(".area-bl > div").scrollTop(r);t.find(".area-tr > div").scrollLeft(u)}}),t.find(".area-bl > div").scroll(function(){if(n(i.tounchTr).length==0||n(i.tounchTr).hasClass("area-bl")){var r=n(this).scrollTop();t.find(".area-br > div").scrollTop(r);clearTimeout(n.data(this,"scrollCheck"))}}),t.find(".styled").uniform(),r.toolbars!=null&&(r.toolbars.create!=null&&n(r.toolbars.create.ele).unbind().click(function(){if(r.toolbars.create.click!=null)r.toolbars.create.click();else{var t=n(this);t.button("loading");i.createOrUpdateObject(null,function(){t.button("reset")})}}),r.toolbars.edit!=null&&(f=r.toolbars.edit,n(f.ele).prop("disabled",!0),n(f.ele).unbind().click(function(){var t=i.getSelectedIds()[0],e=i.getSelectedRow(),r=n(this),u;app.hasValue(t)?(u=i.getDataById(t),(f.before==null||f.before(u))&&(f.click!=null?f.click(t):(r.button("loading"),i.createOrUpdateObject({id:t},function(){r.button("reset")},e)))):app.notify("warning","Vui lòng chọn đối tượng cần sửa")})),r.toolbars.delete!=null&&(e=r.toolbars.delete,n(e.ele).prop("disabled",!0),n(e.ele).unbind().click(function(){var n=i.getCheckedRowIds();n.length>0?(e.before==null||e.before(n))&&i.deleteObjects("bulk",n,function(){i.loadData()}):app.notify("warning","Vui lòng chọn đối tượng cần xóa")})),r.toolbars.reload!=null&&n(r.toolbars.reload.ele).unbind().click(function(){i.loadData()})),t.find('.first-col input[type="checkbox"]').click(function(){var e=t.find(".checkAll"),s=n(this).closest("tr"),i=s.attr("dataid"),f,o;n(this).prop("checked")?(n(u).find('.area-bl tr[dataid="'+i+'"]').addClass("active"),n(u).find('.area-br tr[dataid="'+i+'"]').addClass("active")):(n(u).find('.area-bl tr[dataid="'+i+'"]').removeClass("active"),n(u).find('.area-br tr[dataid="'+i+'"]').removeClass("active"),e.prop("checked")&&e.prop("checked",!1));f=0;o=t.find(" .first-col input");o.each(function(){n(this).prop("checked")==!0&&f++});o.length==f&&e.prop("checked",!0);r.toolbars!=null&&r.toolbars.delete!=null&&(f>0?n(r.toolbars.delete.ele).prop("disabled",!1):n(r.toolbars.delete.ele).prop("disabled",!0));n.uniform.update();r.selectRowCallback!=null&&r.selectRowCallback(s)}),r.filterable){t.find(".tr-filter .btn").unbind().click(function(){});t.find(".tr-filter .select-option").unbind().select2({minimumResultsForSearch:1,dropdownCssClass:"bigdrop"}).on("select2-open",function(){var t=n(this);i.loadFilterOption(t,function(){return t.select2("close").select2("open"),!0})}).on("change",function(t){var s=n(t.target),u=r.rows[s.attr("data-index")],f=u.attribute,h=parseInt(s.attr("data-width")),e,o;u.filter.reload?(e={},e[f]=t.val,i.loadData(e,function(){},!0)):(o=!1,n(i.filter.attrs).each(function(){if(this.attr==f){switch(u.filter.dataType){case"int":this.v=t.val!=""?parseInt(t.val):null;break;case"float":this.v=t.val!=""?parseFloat(t.val):null;break;default:this.v=t.val!=""?t.val:null}o=!0}}),o||i.filter.attrs.push({attr:f,type:"option",v:t.val!=""?t.val:null}),i.search())});t.find(".tr-filter .select-option-remote").each(function(){var u=n(this),f=n(this).attr("data-index"),t=r.rows[f].filter;u.unbind().select2({ajax:{url:t.ajax.url,dataType:"json",quietMillis:200,data:function(i){var r=app.toKeyword(i);return n.extend({keyword:r,limit:10},t.ajax.data)},results:function(i){var r=[];return n(i).each(function(){r.push({id:this[t.ajax.attr.id],text:this[t.ajax.attr.text]})}),{results:r}}},minimumInputLength:1,minimumResultsForSearch:1,dropdownCssClass:"bigdrop",allowClear:!0,placeholder:"Tất cả"}).on("change",function(t){var u=n(t.target),f=r.rows[u.attr("data-index")],e={},o;f.filter.prop!=null?e[f.filter.prop]=t.val:e[f.attribute]=t.val;o=parseInt(u.attr("data-width"));u.closest("div").find(".select2-container").css("width",o-30+"px");i.search(e)})});t.find(".tr-filter .compo-tree").each(function(){var e=n(this),u=e.attr("data-index"),f=r.rows[u].filter,t=f.option,o;t.placeHolder="Tất cả";t.valueType=1;t.width=r.head.groups[u];t.width-=31;t.selectCallback=function(n){var e=r.rows[u],t={};f.prop!=null?t[f.prop]=n:t[e.attribute]=n;i.search(t)};o=e.attr("id");n("#"+o).compoTree(t)});t.find(".tr-filter .datepicker").each(function(){var e=n(this),u=n(this).attr("name"),o=e.attr("data-index"),f=r.rows[o].filter;t.find('.tr-filter div[name="'+u+'"]').compoDate({placeHolder:"Tất cả",days:f.option!=null?f.option.days:null,selectCallback:function(n){var t={};t[u+"From"]=n.from!=null?app.convertVnToEnDate(n.from):null;t[u+"To"]=n.to!=null?app.convertVnToEnDate(n.to):null;i.search(t)}})});t.find(".tr-filter .compo-money").each(function(){var r=n(this).attr("name");t.find('.tr-filter div[name="'+r+'"]').compoMoney({placeHolder:"Tất cả",selectCallback:function(n){var t={};t[r+"From"]=n.from;t[r+"To"]=n.to;i.search(t)}})});t.find(".tr-filter .compo-number").each(function(){var r=n(this).attr("name");t.find('.tr-filter div[name="'+r+'"]').compoNumber({placeHolder:"Tất cả",selectCallback:function(n){var t={};t[r+"From"]=n.from;t[r+"To"]=n.to;i.search(t)}})});o=null;t.find(".filter-contains").unbind().keyup(function(){var t=n(this).attr("attr"),f=n(this),u=n(this).val(),e=f.attr("data-index"),s=r.rows[e].filter;o!=null&&clearTimeout(o);o=setTimeout(function(){var r,f;s.reload?(r={},r[t]=u,i.loadData(r,function(){},!0)):(f=!1,n(i.filter.attrs).each(function(){this.attr==t&&(this.v=u,f=!0)}),f||i.filter.attrs.push({attr:t,type:"contains",v:u}),i.search());clearTimeout(o)},300)})}n(document).on("click",function(t){var u,r;n(t.target).hasClass("edit-inline")||n(t.target).hasClass("span-edit-inline")||n(t.target).closest(".inline-form").length===0&&(u=n(".areas tr td.editing"),u.length>0&&(r=u.find(".form-control"),i.closeEditInline(r,r.val(),r.attr("data-type"))));n(t.target).hasClass("add-inline")||n(t.target).hasClass("span-add-inline")||n(t.target).closest(".inline-form").length===0&&(u=n(".areas tr td.adding"),u.length>0&&(r=u.find(".form-control"),i.closeAddInline(r,r.val(),r.attr("data-type"))))});n('[data-toggle="tooltip"]').tooltip({html:!0})},i.showChild=function(t,r,u){var e=n(t).attr("gid"),f;r?n(t).css("display","table-row"):n(t).css("display","none");f=u.find('tr[parentid="'+e+'"]');f.length>0&&(r?n(t).hasClass("expanded")&&n(f).each(function(){i.showChild(this,!0,u)}):n(f).each(function(){i.showChild(this,!1,u)}))},i.expand=function(t,r,u){var o=r.attr("gid"),f=t.find("i"),s=u.find('tr[parentid="'+o+'"]'),e=r.hasClass("expanded");n(s).each(function(){i.showChild(this,!e,u)});e?(r.removeClass("expanded"),f.removeClass("icon-arrow-down5").addClass("icon-arrow-right5")):(r.addClass("expanded"),f.removeClass("icon-arrow-right5").addClass("icon-arrow-down5"))},i.setRowEvents=function(){var t=n(u).find("> .level-table > .main-content"),f,e,o,s;t.find(".area-bl tbody tr").each(function(){var i=n(this).height(),f=n(this).attr("dataid"),u=t.find('.area-br tr[dataid="'+f+'"]'),r;u.height()>=i?n(this).css("height",u.height()):n(u).css("height",i);r=t.find('.area-bom tr[dataid="'+f+'"]');r.height()>=i?n(this).css("height",r.height()):n(r).css("height",i)});t.find(".area-bl tr").unbind();t.find(".area-br tr").unbind();t.find(".area-bl tr td").unbind();t.find(".area-br tr td").unbind();t.find(".styled").uniform();t.find(".area-bl tr td").click(function(t){t.target==this&&i.selectRow(n(this).closest("tr"))});t.find(".area-br tr td").click(function(t){t.target==this&&i.selectRow(n(this).closest("tr"))});t.find(".area td.edit-inline").click(function(u){var o,s,f,h,e,c,l;if(u.target==this&&!n(this).hasClass("editing"))if(o=n(this),s=t.find(".area td.editing .inline-form .form-control"),s.length>0&&i.closeEditInline(s,s.val(),s.attr("data-type")),o.addClass("editing"),f=o.find(".form-control"),n(f).is("select"))n(f).trigger("open");else if(f.hasClass("select-inline-remote"))if(o.hasClass("loaded"))f.select2("open");else{h=f.attr("data-index");e=r.rows[h].editInline;f.unbind().select2({width:e.width!=null?e.width:250,ajax:{url:e.ajax.url,dataType:"json",quietMillis:200,data:function(t){var i=app.toKeyword(t);return n.extend({keyword:i,limit:10},e.ajax.data)},results:function(t){var i=[];return n(t).each(function(){i.push({id:this[e.ajax.attr.id],text:this[e.ajax.attr.text]})}),{results:i}}},placeholder:"Search for a repository",minimumInputLength:1,minimumResultsForSearch:1});c=parseInt(o.closest("tr").attr("dataid"));l=i.getDataById(c);e.before(f,l);f.on("change",function(n){i.closeEditInline(f,n.val)});o.addClass("loaded");f.select2("open")}else f.focus().select()});t.find("span.span-edit-inline").click(function(){n(this).closest("td").trigger("click")});t.find('.area td.edit-inline input[type="checkbox"]').change(function(t){t.target==this&&i.closeEditInline(n(this),n(this).prop("checked"))});t.find(".area td.edit-inline select").change(function(t){t.target==this&&i.closeEditInline(n(this),n(this).val())});t.find(".area td.add-inline").click(function(r){var u,f;r.target==this&&(n(this).hasClass("editing")||(u=t.find(".area td.editing > .inline-form .form-control"),u.length>0&&i.closeAddInline(u,u.val()),n(this).addClass("adding"),f=n(this).find(".form-control"),n(f).is("select")?n(f).trigger("open"):f.focus().select()))});t.find(".area td.add-inline > span").click(function(){n(this).closest("td").trigger("click")});t.find(".btn-expander").unbind().click(function(){var r=n(this),u=r.closest("tr");i.expand(r,u,t)});t.find(".area-bl tr").hover(function(){var t=n(this).attr("dataid");n(this).addClass("hover");n(u).find('.area-br tr[dataid="'+t+'"]').addClass("hover")},function(){var t=n(this).attr("dataid");n(u).find('.area-br tr[dataid="'+t+'"]').removeClass("hover");n(this).removeClass("hover")});t.find(".area-br tr").hover(function(){var t=n(this).attr("dataid");n(u).find('.area-bl tr[dataid="'+t+'"]').addClass("hover");n(this).addClass("hover")},function(){var t=n(this).attr("dataid");n(u).find('.area-bl tr[dataid="'+t+'"]').removeClass("hover");n(this).removeClass("hover")});f=t.find(".area td.edit-inline input");f.unbind();f.keydown(function(){var s=event.keyCode?event.keyCode:event.which,u=n(this).val(),h,f,e,t,o,r;if(s==9)return i.closeEditInline(n(this),u),u=n(this).val(),h=n(this).attr("attr"),o=n(this).closest("td"),e=parseInt(o.attr("i")),f=n(this).closest("tr"),r=f.find("td.edit-inline"),t=null,n(r).each(function(){var i=parseInt(n(this).attr("i"));if(i>e)return t=n(this),!1}),t==null&&(t=r.first()),t.length>0&&(t.addClass("editing"),t.find("input").focus().select()),!1});f.keyup(function(){var c=event.keyCode?event.keyCode:event.which,h=n(this).val(),e,u,o,f,t,r,s;if(!(c>=65)||!(c<=90))switch(c){case 13:case 40:i.closeEditInline(n(this),h);e=n(this).closest("td").attr("i");u=n(this).closest("tr");o=u.closest("body");f=parseInt(u.attr("ai"));t=o.find('tr[ai="'+(f+1)+'"]');t.length==0&&(t=o.find('tr[ai="1"]'));t.length>0&&(r=t.find('td[i="'+e+'"]'),r.length>0&&(r.addClass("editing"),r.find("input").focus().select()));break;case 39:i.closeEditInline(n(this),h);e=n(this).attr("attr");r=n(this).closest("td");f=parseInt(r.attr("i"));u=n(this).closest("tr");s=u.find("td.edit-inline");t=null;n(s).each(function(){var i=parseInt(n(this).attr("i"));if(i>f)return t=n(this),!1});t==null&&(t=s.first());t.length>0&&(t.addClass("editing"),t.find("input").focus().select());break;case 37:i.closeEditInline(n(this),h);e=n(this).attr("attr");r=n(this).closest("td");f=parseInt(r.attr("i"));u=n(this).closest("tr");s=u.find("td.edit-inline");t=null;n(s).each(function(){var i=parseInt(n(this).attr("i"));i<f&&(t=n(this))});t==null&&(t=s.last());t.length>0&&(t.addClass("editing"),t.find("input").focus().select());break;case 38:i.closeEditInline(n(this),h);e=n(this).closest("td").attr("i");u=n(this).closest("tr");o=u.closest("body");f=parseInt(u.attr("ai"));t=o.find('tr[ai="'+(f-1)+'"]');t.length==0&&(t=o.find("tr:not(.tr-total)").last());t.length>0&&(r=t.find('td[i="'+e+'"]'),r.length>0&&(r.addClass("editing"),r.find("input").focus().select()))}});e=t.find(".area td.add-inline input");e.unbind();e.keyup(function(){var t=event.keyCode?event.keyCode:event.which,r=n(this).val();t==13&&i.closeAddInline(n(this))});t.find(".btn-add-row").unbind().click(function(){var u=n(this).attr("groupid"),f=n(this).closest("tr"),t={};t[r.group.attr]=u;i.createOrUpdateObject(t,null,f)});r.contextMenu!=null&&(o=n(u).find("> .context-menu-salary-grid-popup"),t.find('.area-br tr[data-toggle="context"]').contextmenu({target:o.selector,before:function(t,u){t.preventDefault();i.moveObjectId!=null?this.getMenu().find("li .near").removeClass("disabled"):this.getMenu().find("li .near").addClass("disabled");var e=this.getMenu(),o=n(u).attr("dataid"),f=i.getDataById(o);return n(r.contextMenu).each(function(){var n=e.find("a."+this.class).closest("li"),t;this.enable==null||this.enable(f)?(n.css("display","block"),this.visible==null||this.visible(f)?this=="edit"||this=="delete"?(t=e.find('a[action="edit"], a[action="delete"]'),f.Status!=null&&f.Status>0?t.addClass("disabled"):t.removeClass("disabled")):n.find("a").removeClass("disabled"):n.find("a").addClass("disabled")):n.css("display","none")}),!0},onItem:function(t,r){var u=n(r.currentTarget);u.hasClass("dropdown-submenu")?i.clickSubContextMenu?i.clickSubContextMenu=!1:(i.clickContextMenu(t,r),i.clickSubContextMenu=!0):n(r.target).hasClass("disabled")||i.clickContextMenu(t,r)}}),t.find('.area-bl tr[data-toggle="context"]').contextmenu({target:o.selector,before:function(t,u){t.preventDefault();i.moveObjectId!=null?this.getMenu().find("li .near").removeClass("disabled"):this.getMenu().find("li .near").addClass("disabled");var e=this.getMenu(),o=n(u).attr("dataid"),f=i.getDataById(o);return n(r.contextMenu).each(function(){var n=e.find("a."+this.class).closest("li");this.enable==null||this.enable(f)?(n.css("display","block"),this.visible==null||this.visible(f)?n.find("a").removeClass("disabled"):n.find("a").addClass("disabled")):n.css("display","none")}),!0},onItem:function(t,r){var u=n(r.currentTarget);u.hasClass("dropdown-submenu")?i.clickSubContextMenu?i.clickSubContextMenu=!1:(i.clickContextMenu(t,r),i.clickSubContextMenu=!0):n(r.target).hasClass("disabled")||i.clickContextMenu(t,r)}}));t.find(".check-group").unbind().click(function(){var t=n(this).attr("gid"),u=n(this).is(":checked");i.checkChilds(t,u);n.uniform.update();r.selectRowCallback!=null&&r.selectRowCallback()});t.find(".checkAll").unbind().click(function(){var i=n(this).is(":checked");t.find('.area-bl td input[type="checkbox"]').prop("checked",i);t.find('.area-br td input[type="checkbox"]').prop("checked",i);n.uniform.update();r.selectRowCallback!=null&&r.selectRowCallback()});t.find(".check-item").click(function(){var r=n(this).is(":checked"),t=n(this).closest("tr").attr("gid");console.log(t);i.checkChilds(t,r)});r.height.fixHeight!=!0&&(s=t.find(".area-bl tbody tr.tr-child"),s.each(function(){var i=n(this).height(),f=n(this).attr("dataid"),u=t.find('.area-br tr[dataid="'+f+'"]'),r;u.height()>=i?n(this).css("height",u.height()):n(u).css("height",i);r=t.find('.area-bom tr[dataid="'+f+'"]');r.height()>=i?n(this).css("height",r.height()):n(r).css("height",i)}))},i.checkChilds=function(t,r){var e=n(u).find("> .level-table > .main-content"),f=e.find(' .area-bl tr[parentid="'+t+'"] ');f.length>0&&n(f).each(function(){var t=n(this).attr("gid");i.checkChilds(t,r);n(this).find("input.check-item").prop("checked",r);n.uniform.update()})},i.clearCheckbox=function(){var t=n(u).find("> .level-table > .main-content");t.find(".checkAll").prop("checked",!1);t.find(".check-group").prop("checked",!1);n.uniform.update()},i.clickContextMenu=function(t,u){var o=n(u.target),s,h,e,c,l;o[0].hasAttribute("action")||(o=n(u.target).closest("a"));var f=n(t.context),v=o.attr("action"),a=o.attr("class");switch(v){case"edit":s=n(f).attr("dataid");i.createOrUpdateObject({id:s},function(){},n(f));break;case"delete":s=n(f).attr("dataid");i.deleteObjects("bulk",[s],function(){console.log("reload...");i.loadData()});break;case"insert-child":i.insertRow({insertType:"Child",currentId:f.attr("dataid"),id:null});break;case"insert-top":i.insertRow({insertType:"Near",insertPosition:"Top",currentId:f.attr("dataid"),parentId:f.attr("parent")});break;case"insert-bottom":i.insertRow({insertType:"Near",insertPosition:"Bottom",currentId:f.attr("dataid"),parentId:f.attr("parent")});break;case"custom":for(h=0;h<r.contextMenu.length;h++)if(e=r.contextMenu[h],a==e.class){if(e.click!=null)return e.click(f),!1}else if(e.childs!=null)for(c=0;c<e.childs.length;c++)if(l=e.childs[c],a==l.class&&l.click!=null)return l.click(f),!1}},i.updateRowValue=function(t,u,f){var l=parseInt(t.attr("dataid")),s=i.getDataById(parseInt(l)),h,e;for(s[u]=f,h=0;h<r.rows.length;h++)if(e=r.rows[h],e.formula!=null){var f=e.formula(s),o=f,c=t.find('td[data-attr="'+e.attribute+'"]');o=e.fixed!=null?o.toFixed(e.fixed):Math.round(o);o=e.type=="price"?app.formatPrice(o):o;c.attr("data-val",f);n(c.find("span")).text(o);n(c.find("input")).val(o);s[e.attribute]=f}return i.setDataById(s,null),s},i.setDataById=function(n,t){t==null&&(t=i.sourceData);for(var r=0;r<t.length;r++){if(t[r].Id==n.Id){t[r]=n;return}t[r].Childs!=null&&i.setDataById(n,t[r].Childs)}},i.getChildsByParentId=function(t,r){var u=[];return r==null&&(r=i.sourceData),n(r).each(function(){this.Id==t?u=this.Childs:this.Childs!=null&&(u=i.getChildsByParentId(t,this.Childs))}),u},i.updateSumableValue=function(t){var h=n(t).attr("gid"),c=n(u).find("> .level-table > .main-content"),s=c.find('.area tr[parentid="'+h+'"]'),o,f,e;if(s.length>0)for(n(s).each(function(){i.updateSumableValue(this)}),o=0;o<r.rows.length;o++)f=r.rows[o],f.sumable&&(e=0,n(s).each(function(){var t=n(this).find('td[data-attr="'+f.attribute+'"]').attr("data-val");app.hasValue(t)&&n.isNumeric(t)&&(e+=parseFloat(t))}),console.log(t,e),n(t).find('td[data-attr="'+f.attribute+'"]').attr("data-val",e),n(t).find('td[data-attr="'+f.attribute+'"] input.form-control').val(e),n(t).find('td[data-attr="'+f.attribute+'"] span').text(app.formatPrice(e)))},i.updateTotalRow=function(){for(var t,u,f=0;f<r.rows.length;f++)t=r.rows[f],t.sumable&&(u=0,n(i.sourceData).each(function(){var r=this,i=n('.area .tr-group[dataid="'+r.Id+'"] td[data-attr="'+t.attribute+'"] span').text();i=i.replace(/,/g,"");i=parseFloat(i);u+=i}),u=t.fixed!=null?u.toFixed(t.fixed):app.formatPrice(Math.round(u)),n('.tr-total td[data-attr="'+t.attribute+'"] strong').text(u))},i.closeEditInline=function(t,f){var s=t.closest("tr"),a=t.attr("attr"),l=t.attr("data-type"),h=t.closest("td"),v=parseInt(n(h).attr("ci")),e=r.rows[v],c;l=="price"&&(n.isNumeric(f)?(f=f.replace(/,/g,""),f=parseFloat(f),e.min!=null&&f<e.min&&(f=e.min),e.max!=null&&f>e.max&&(f=e.max),t.val(f)):(f="0",t.val(f)));h.removeClass("editing");h.attr("data-val",f);var o=i.updateRowValue(s,a,f),y=n(u).find("> .level-table > .main-content"),p=n(u).find("> .level-table > .main-content .area .tr-group");n(p).each(function(){var u=this,o=n(u).attr("gid"),s=y.find('.area tr[parentid="'+o+'"]'),f,t,e;for(i.updateSumableValue(u),f=0;f<r.rows.length;f++)t=r.rows[f],t.sumable&&(e=0,n(s).each(function(){var i=n(this).find('td[data-attr="'+t.attribute+'"]').attr("data-val");app.hasValue(i)&&n.isNumeric(i)&&(e+=parseFloat(i))}),n(u).find('td[data-attr="'+t.attribute+'"] input.form-control').val(e),n(u).find('td[data-attr="'+t.attribute+'"] span').text(app.formatPrice(e)))});i.updateTotalRow();c=r.editController!=null?r.editController+"/":"/admin/";c+=r.model+"EditRow";r.params.edit!=null&&n.extend(o,r.params.edit);n(i.editLoader).show();app.postData(c,o,function(r){var h,y;if(n(i.editLoader).hide(),h=t.closest("td"),e.editInline.reDraw){if(r.Data!=null){o=n.extend(o,r.Data);var p=s.attr("ai"),w=s.attr("data-level"),c=i.drawRowWithoutTr(o,p,w),a=n(u).find("> .level-table > .main-content"),v=s.attr("gid");a.find('.area-bl tr[gid="'+v+'"]').html(c.left);a.find('.area-br tr[gid="'+v+'"]').html(c.right);i.setRowEvents()}}else n(t).is("select")?(y=t.find(" option:selected").text(),h.find(".span-edit-inline").text(y)):(l=="price"&&(f=app.formatPrice(f)),h.find(".span-edit-inline").text(f));h.removeClass("editing")})},i.closeAddInline=function(t){var o=t.val(),c=t.attr("attr"),l=t.closest("tr"),u=parseInt(l.attr("groupid")),s=parseInt(t.attr("stt")),h=t.closest("td"),e,f;o.length>0?(e=r.editController!=null?r.editController+"/":"/admin/",e+=r.model+"addRow",f={stt:s+1},f[c]=o,f[r.relateId]=u,r.params.add!=null&&n.extend(f,r.params.add),n(t).prop("disabled",!0),n(i.editLoader).show(),app.postData(e,f,function(r){if(n(i.editLoader).hide(),r.Success){var f=r.Data,e=n(".area-bl table tbody"),o=n(".area-br table tbody");n(i.sourceData).each(function(){var t,r,s;this.Id==u&&(t=i.drawRow(f,"Id",this.Childs.length+1,u),this.Childs.length>0?(r=e.find('.tr-child.tr-real[groupid="'+u+'"]').last(),s=o.find('.tr-child.tr-real[groupid="'+u+'"]').last(),n(r).after(t.left),n(s).after(t.right)):(r=e.find('.tr-group[groupid="'+u+'"]'),s=o.find('.tr-group[groupid="'+u+'"]'),n(r).after(t.left),n(s).after(t.right)),this.Childs.push(f))});n(t).attr("stt",s+1)}else app.notify("warning",r.Message);n(t).val("").prop("disabled",!1);h.removeClass("adding");i.setRowEvents()})):h.removeClass("adding")},i.displayChilds=function(t,r,f){var e=f?n(u).find("> .level-table > .main-content .area-bl tr"):n(u).find("> .level-table > .main-content .area-br tr");e.each(function(){var u=n(this).attr("parent");u==t&&(n(this).css("display",r),i.displayChilds(n(this).attr("dataid"),r,f))})},i.bulkDelete=function(n){var t=i.getSelectedIds();t.length>0?i.deleteObjects("bulk",t,n):app.confirm("info","Vui lòng chọn đối tượng cần xóa",null,null)},i.deleteObjects=function(t,i,f){app.confirm("warning",null,i.length+" đối tượng được chọn để xóa.",function(){var e=r.editController!=null?r.editController:"/admin";t=="bulk"?app.postData(e+"/delete"+r.model+"ByIds",{ids:i},function(){f!=null&&f()}):n.ajax({url:e+"/delete"+r.model,type:"POST",data:{model:r.model,id:i[0]},success:function(){typeof webaby!="undefined"&&webaby.hideModalLoading();n("#deleteModal").modal("hide");f!=null&&f()}});n(u).find(".checkAll").prop("checked",!1);n.uniform.update()})},i.setSubData=function(){},i.selectRow=function(t){var i=t.attr("dataid");t.hasClass("active")?(n(u).find('.area-bl tr[dataid="'+i+'"]').removeClass("active"),n(u).find('.area-br tr[dataid="'+i+'"]').removeClass("active"),n(u).find('.area-bom tr[dataid="'+i+'"]').removeClass("active")):(n(u).find(".area-bl tr.active").removeClass("active"),n(u).find('.area-bl tr[dataid="'+i+'"]').addClass("active"),n(u).find(".area-br tr.active").removeClass("active"),n(u).find('.area-br tr[dataid="'+i+'"]').addClass("active"),n(u).find(".area-bom tr.active").removeClass("active"),n(u).find('.area-bom tr[dataid="'+i+'"]').addClass("active"),r.selectRowCallback!=null&&r.selectRowCallback(t))},i.resize=function(){var t=null,e=null;if(app.hasValue(r.height.fix)&&(t=r.height.fix),app.hasValue(r.width.fix)&&(e=r.width.fix),t==null){var o=n(window).height(),f=o-r.height.top,s=n(u).find("> .level-table");s.css("height",f);r.paging!=null&&(f-=50);i.setMainTableHeight(f)}else i.setMainTableHeight(t);e==null&&i.setMainTableWidth()},i.setMainTableWidth=function(){var t=n(u).find("> .level-table > .main-content .area-tr"),s=n(u).find("> .level-table > .main-content .area-br"),r=t.find("> div").width(),f=parseInt(t.find("table").attr("data-w")),e=t.find("table > colgroup col").last(),o=s.find("table > colgroup col").last(),i;r>=f?(i=r-f-19,e.css("width",i),o.css("width",i)):(e.css("width",0),o.css("width",0))},i.setMainTableHeight=function(t){var f=r.head.height!=null?r.head.height:32,i;r.filterable&&(f+=37);i=n(u).find("> .level-table > .main-content");i.css("height",t+35);i.find("> .areas").css("height",t);i.find("> .areas .area-bl").css("height",t-f-18);i.find("> .areas .area-bl > div").css("height",t-f-2);i.find("> .areas .area-br").css("height",t-f-1);i.find("> .areas .area-br > div").css("height",t-f-2)},i.setPagination=function(t){var l,f,e,o,c,s,h;if(t==0)n(u).find(".pagination").css("display","none");else{if(l=i.searchParams.unlimited?t:i.searchParams.limit,n(u).find(".pagination").css("display","block"),f=n(u).find(".pagination"),n(f).html(""),o=parseInt(t/l),t%l!=0&&o++,i.searchParams.page<=2?e=1:i.searchParams.page>=o-3?(e=o-4,e<1&&(e=1)):e=i.searchParams.page-2,s=e,r.paging!=null&&(s+=r.paging.pageNumber!=null?r.paging.pageNumber:5),o<5&&(s=e+o),s>1){for(s>2&&n(f).append('<li><a href="#" class="pre"><span>←<\/span><\/a><\/li>'),h=e;h<s;h++)c="<li>",h==i.searchParams.page&&(c='<li class="active">'),c+='<a href="#" page='+h+">"+h+"<\/a><\/li>",n(f).append(c);s>2&&n(f).append('<li><a href="#" class="next"><span>→<\/span><\/a><\/li>')}n(f).find("a").unbind().click(function(){return i.searchParams.page=n(this).attr("page"),i.loadData(),!1});n(f).find(".pre").unbind().click(function(){return i.searchParams.page>1&&(i.searchParams.page--,i.loadData()),!1});n(f).find(".next").unbind().click(function(){return i.searchParams.page<o&&(i.searchParams.page++,i.loadData()),!1})}},i.initTable=function(){var it,o,g,st,ht,c,rt,et,k,t,b,ot,s,ut,ft,l,a,v,ct;r.height.row!=null&&(i.hr=r.height.row);var h=r.skipCols,nt=r.group,lt=n(window).height(),tt="",y="",p=0,w=0,f,d,e=n('<div class="level-table  '+(r.border?"bordered":"")+" "+(r.evenColor?"even-color":"")+'"><\/div>');if(app.hasValue(r.height.fix)?e.css("height",r.height.fix):e.css("height",lt-r.height.top),e.append('<div class="main-content"><div class="areas '+(h>0?"has-left":"")+'"><span class="empty-message" style="display: none">Không tìm thấy dữ liệu phù hợp<\/span><\/div><\/div>'),n(u).append(e),it=r.head.height!=null?r.head.height:32,r.filterable&&(it+=37),o=n('<div class="area area-tl" style="height: '+it+'px"><div><\/div><\/div>'),h>0){for(e=n('<table class="table table-bordered"><\/table>'),tt=n("<colgroup><\/colgroup>"),p=0,(r.checkAll==null||r.checkAll)&&(tt.append('<col style="width: 40px">'),p+=40,h--),s=0;s<h;s++)tt.append('<col style="width: '+r.head.groups[s]+'px">'),p+=r.head.groups[s];for(e.css("width",p).append(tt.html()),f="<thead>",h=r.skipCols,d=r.cols.left,a=0;a<d.length;a++){for(g=d[a],f+="<tr>",a==0&&(r.checkAll==null||r.checkAll)&&(f+='<th rowspan="'+d.length+'" style="height: 31px"><div class="checkbox"><input type="checkbox" class="styled checkAll" /><label><\/label><\/div><\/th>',h--),k=0;k<g.length;k++)t=g[k],(t.visible==null||t.visible())&&(f+="<th ",t.rowspan!=null&&(f+=' rowspan="'+t.rowspan+'" '),t.colspan!=null&&(f+=' colspan="'+t.colspan+'" '),f+=' style="',t.style!=null&&(f+=t.style+"; "),f+='"',b="",t.class!=null&&(b+=t.class),t.color!=null&&(b+=" hc-"+t.color+" "),f+=t.sort!=null?'class="'+b+' orderable" orderby="'+t.sort+'" currentOrder="desc">':'class="'+b+'" >',f+=t.render!=null?t.render():t.title!=null?t.title:"&nbsp;",f+=(t.sort!=null?'<i style="margin-left:5px;" class="fa fa-caret-down"><\/i>':"")+"<\/th>");f+="<\/tr>"}f+="<\/thead>";e.append(f);r.filterable&&(st=i.rowFilter(!0),e.append("<tbody>"+st+"<\/tbody>"));o.css("width",p+1).find("> div").append(e)}for(n(u).find(".areas").append(o),ht=n(window).width(),o=n('<div class="area area-bl" style="width:'+(p+(ht>375?19:1)-3)+'px"><\/div>'),o.append('<div><table class="table table-bordered table-hover" style="width:'+p+'px"><\/table><\/div>'),o.find("table").append(tt),c="<tbody>",nt!=null&&(rt=0,n(nt.data).each(function(){var n=this,t=0,u;t=i.hr*n.totalChild;u=rt+t+i.hr;c+='<tr class="tr-group expanded '+(n.class!=null?n.class:"")+'" groupid="'+n.id+'"  data-p1="'+rt+'" data-p2="'+u+'"><td colspan="'+(r.checkAll==null||r.checkAll?h+1:h)+'" class="'+(n.class!=null?n.class:"")+'" style="height:'+i.hr+'px">';c+="<div>";r.checkAll&&(c+='<div class="checkbox"><input type="checkbox" class="styled check-group" groupid="'+n.id+'" /><label><\/label><\/div>');c+='<button class="btn btn-icon btn-xs btn-expander"><i class="icon-arrow-down5"><\/i><\/button> ';c+=nt.render!=null?nt.render(n):this.text;nt.addable&&(c+='<button class="btn btn-icon btn-xs btn-add-row bg-primary" groupid="'+n.id+'" type="button"><i class="icon-plus3"><\/i><\/button>');c+="<\/div><\/td><\/tr>";c+='<tr class="tr-group-overload tr-group-overload-top"  groupid="'+n.id+'" style = "display: none"><td style="height: 0px">&nbsp;<\/td><\/tr>';c+='<tr class="tr-group-overload tr-group-overload-bot"  groupid="'+n.id+'" '+(n.totalChild==0?'style="display: none"':"")+'><td style="height: '+t+'px">&nbsp;<\/td><\/tr>';rt+=t+i.hr})),c+="<\/tbody>",o.find("table").append(c),n(u).find(".areas").append(o),et=r.optionMenu!=null&&browser=="Wap",h=r.skipCols,o=n('<div class="area area-tr" style="left: '+p+"px; height: "+it+"px; "+(et?"right: 35px;":"")+'"><div><\/div><\/div>'),e=n('<table class="table table-bordered"><\/table>'),y=n("<colgroup><\/colgroup>"),w=0,(r.checkAll==null||r.checkAll)&&(h==0?(y.append('<col style="width: 40px">'),w+=40):h--),s=h;s<r.head.groups.length;s++)y.append('<col i="'+s+'" w="'+r.head.groups[s]+'" style="width: '+r.head.groups[s]+'px">'),w+=r.head.groups[s];for(y.append("<col>"),e.attr("data-w",w).css("width",+w+"px").append(y),f="<thead>",h=r.skipCols,d=r.cols.right,a=0;a<d.length;a++){for(g=d[a],f+="<tr>",k=0;k<g.length;k++)t=g[k],(t.visible==null||t.visible())&&(f+="<th ",t.rowspan!=null&&(f+=' rowspan="'+t.rowspan+'" '),t.colspan!=null&&(f+=' colspan="'+t.colspan+'" '),f+=' style="',t.style!=null&&(f+=t.style+"; "),f+='"',b="",t.class!=null&&(b+=t.class),t.color!=null&&(b+=" hc-"+t.color+" "),f+='class="'+b+'" ri="'+(a+1)+'" ci="'+t.ci+'" >',t.note!=null&&(f+='<span class="th-tooltip"><i class="icon-info22" data-toggle="tooltip" data-placement="bottom" title="'+t.note+'"><\/i><\/span>'),f+='<span class="title ell">',ot="",ot=t.render!=null?t.render():t.title!=null?t.title:"&nbsp;",f+=ot,f+="<\/th>");f+="<th>&nbsp;<\/th>";f+="<\/tr>"}for(f+="<\/thead>",e.append(f),r.filterable&&e.append("<tbody>"+i.rowFilter(!1)+"<\/tbody>"),o.find("> div").append(e),n(u).find(".areas").append(o),h=r.skipCols,o=n('<div class="area area-br" style="left: '+p+"px;"+(et?"right: 35px;":"")+'"><div><\/div><\/div>'),e=n('<table class="table table-bordered table-hover"><\/table>'),y=n("<colgroup><\/colgroup>"),w=0,(r.checkAll==null||r.checkAll)&&(h==0?(y.append('<col style="width: 40px" w="40">'),w+=40):h--),i.colRight=r.head.groups.length-h,s=h;s<r.head.groups.length;s++)y.append('<col i="'+s+'" w="'+r.head.groups[s]+'" style="width: '+r.head.groups[s]+'px">'),w+=r.head.groups[s];if(y.append("<col>"),c="<tbody>",c+="<\/tbody>",e.css("width",+w+"px").append(y).append(c),o.find("> div").append(e),n(u).find(".areas").append(o),r.optionMenu!=null&&browser=="Wap"&&(o=n('<div class="area area-tom" style="right: 0; height: '+it+'px"><div><\/div><\/div>'),e=n('<table class="table"><colgroup><col style="width: 40px" /><\/colgroup><thead><th style="height: 30px">&nbsp;<\/th><\/thead><\/table>'),r.filterable&&e.append('<tbody><tr class="tr-filter"><td><\/td> <\/tr><\/tbody>'),o.find("> div").append(e),n(u).find(".areas").append(o),o=n('<div class="area area-bom" style="right: 0; top: 63px"><div><\/div><\/div>'),e=n('<table class="table table-bordered"><tbody><\/tbody><\/table>'),o.find("> div").append(e),n(u).find(".areas").append(o)),n(u).find(".areas").append('<span class="buffer-bl" style="width: '+p+'px"><\/span>'),r.footer!=!1&&(ut=n('<div class="area-footer"><\/div'),ut.append('<span class="heading-text total-row"><span class="text-bold">0<\/span> kết quả<\/span>'),ft=n('<div class="icons-list pull-right"><\/div>'),ft.append('<li class="btn-group dropup " style="float:left; margin-right: 10px"><span class="">Hiển thị<button type="button" class="dropdown-toggle btn btn-xs btn-default position-right" data-toggle="dropdown" aria-expanded="false"><span>20 kết quả<\/span> <label class="caret"><\/label><\/button><ul class="dropdown-menu dropdown-menu-right"><li><a href="#" class="btn-change-limit" data="10">10 kết quả<\/a><\/li><li><a href="#" class="btn-change-limit" data="20">20 kết quả<\/a><\/li><li><a href="#" class="btn-change-limit" data="50">50 kết quả<\/a><\/li><li><a href="#" class="btn-change-limit" data="">Tất cả<\/a><\/li><\/ul><\/li>'),ft.append('<li><ul class="pagination pagination-flat pagination-xs"><\/ul><\/li>'),ut.append(ft),n(u).find(".main-content").append(ut)),r.contextMenu!=null){for(l='<div class="context-menu-salary-grid-popup"><ul class="dropdown-menu">',a=0;a<r.contextMenu.length;a++){v=r.contextMenu[a];switch(v){case"edit":l+='<li><a href="#" action="edit"><i class="icon-pencil7 position-left"><\/i>Cập nhật<\/a><\/li>';break;case"delete":l+='<li><a href="#" action="delete"><i class="icon-x position-left"><\/i>Xóa<\/a><\/li> ';break;case"insertChild":l+='<li><a href="#" action="insert-child"><i class="icon-add-to-list position-left"><\/i>Thêm cấp con<\/a><\/li> ';break;case"insertTop":l+='<li><a href="#" action="insert-top"><i class="icon-add-to-list position-left"><\/i>Thêm 1 dòng phía trên<\/a><\/li> ';break;case"insertBottom":l+='<li><a href="#" action="insert-bottom"><i class="icon-add-to-list position-left"><\/i>Thêm 1 dòng phía dưới<\/a><\/li> ';break;case"-":l+='<li class="divider" ><\/li>';break;default:v.childs!=null?(l+='<li class="dropdown-submenu dropdown-submenu-hover">',l+='<a href="#"><i class="'+v.icon+' position-left" ><\/i>'+v.text+"<\/a>",l+='<ul class="dropdown-menu">',n.each(v.childs,function(){l+='<li> <a href="#"  action="custom" class="'+this.class+'">'+this.text+"<\/a><\/li> "}),l+="<\/ul>",l+="<\/li>"):l+='<li><a href="#" title="'+v.text+'" action="custom" class="'+v.class+'">'+(v.icon!=null?'<i class="'+v.icon+'"><\/i>':"")+v.text+"<\/a><\/li> "}}l+="<\/ul> <\/div>";n(u).append(l)}i.setStaticEvents();r.data!=null?(ct=n(u).find("> .level-table > .main-content"),i.setViewData(r.data,!0),i.sortai(),i.set.sumInfo!=null&&i.drawSuminfo(ct)):r.autoLoad!=!1&&i.loadData()},i.initTable(),i.insertRow=function(t){var u,f;i.showTableLoading();u=r.editController!=null?r.editController+"/":"/admin/";u+="Insert"+r.model+"Row";f=i.editParams;n.extend(f,t);app.postData(u,f,function(n){i.hideTableLoading();n.Success?i.loadData():app.notify("warning",n.Message)})},i.pushDataByParentId=function(t,r,u){u==null&&(u=i.sourceData);n(u).each(function(){if(this.Id==r){this.Childs==null&&(this.Childs=[]);this.Childs.push(t);return}this.Childs.length>0&&i.pushDataByParentId(t,r,this.Childs)})},i}})(jQuery)