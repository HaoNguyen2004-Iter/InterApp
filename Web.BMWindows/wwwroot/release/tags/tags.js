!function(n){"use strict";function i(t,i){this.isInit=!0;this.itemsArray=[];this.$element=n(t);this.$element.hide();this.isSelect="SELECT"===t.tagName;this.multiple=this.isSelect&&t.hasAttribute("multiple");this.objectItems=i&&i.itemValue;this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"";this.inputSize=Math.max(1,this.placeholderText.length);this.$container=n('<div class="bootstrap-tagsinput"><\/div>');this.$input=n('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container);this.$element.before(this.$container);this.build(i);this.isInit=!1}function r(n,t){if("function"!=typeof n[t]){var i=n[t];n[t]=function(n){return n[i]}}}function u(n,t){if("function"!=typeof n[t]){var i=n[t];n[t]=function(){return i}}}function t(n){return n?o.text(n).html():""}function f(n){var t=0,i;return document.selection?(n.focus(),i=document.selection.createRange(),i.moveStart("character",-n.value.length),t=i.text.length):(n.selectionStart||"0"==n.selectionStart)&&(t=n.selectionStart),t}function s(t,i){var r=!1;return n.each(i,function(n,i){if("number"==typeof i&&t.which===i)return r=!0,!1;if(t.which===i.which){var u=!i.hasOwnProperty("altKey")||t.altKey===i.altKey,f=!i.hasOwnProperty("shiftKey")||t.shiftKey===i.shiftKey,e=!i.hasOwnProperty("ctrlKey")||t.ctrlKey===i.ctrlKey;if(u&&f&&e)return r=!0,!1}}),r}var e={tagClass:function(){return"label label-info"},focusClass:"focus",itemValue:function(n){return n?n.toString():n},itemText:function(n){return this.itemValue(n)},itemTitle:function(){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(n,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,triggerChange:!0},o;i.prototype={constructor:i,add:function(i,r,u){var f=this,a,e,o,l,h,w,c,b;if(!(f.options.maxTags&&f.itemsArray.length>=f.options.maxTags)&&(i===!1||i)){if("string"==typeof i&&f.options.trimValue&&(i=n.trim(i)),"object"==typeof i&&!f.objectItems)throw"Can't add objects when itemValue option is not set";if(!i.toString().match(/^\s*$/)){if((f.isSelect&&!f.multiple&&f.itemsArray.length>0&&f.remove(f.itemsArray[0]),"string"==typeof i&&"INPUT"===this.$element[0].tagName)&&(a=f.options.delimiterRegex?f.options.delimiterRegex:f.options.delimiter,e=i.split(a),e.length>1)){for(o=0;o<e.length;o++)this.add(e[o],!0);return void(r||f.pushVal(f.options.triggerChange))}var s=f.options.itemValue(i),v=f.options.itemText(i),k=f.options.tagClass(i),y=f.options.itemTitle(i),p=n.grep(f.itemsArray,function(n){return f.options.itemValue(n)===s})[0];if(!p||f.options.allowDuplicates)f.items().toString().length+i.length+1>f.options.maxInputLength||(l=n.Event("beforeItemAdd",{item:i,cancel:!1,options:u}),(f.$element.trigger(l),l.cancel)||(f.itemsArray.push(i),h=n('<span class="tag '+t(k)+(null!==y?'" title="'+y:"")+'">'+t(v)+'<span data-role="remove"><\/span><\/span>'),h.data("item",i),f.findInputWrapper().before(h),h.after(" "),w=n('option[value="'+encodeURIComponent(s)+'"]',f.$element).length||n('option[value="'+t(s)+'"]',f.$element).length,f.isSelect&&!w&&(c=n("<option selected>"+t(v)+"<\/option>"),c.data("item",i),c.attr("value",s),f.$element.append(c)),r||f.pushVal(f.options.triggerChange),(f.options.maxTags===f.itemsArray.length||f.items().toString().length===f.options.maxInputLength)&&f.$container.addClass("bootstrap-tagsinput-max"),n(".typeahead, .twitter-typeahead",f.$container).length&&f.$input.typeahead("val",""),this.isInit?f.$element.trigger(n.Event("itemAddedOnInit",{item:i,options:u})):f.$element.trigger(n.Event("itemAdded",{item:i,options:u}))));else if(f.options.onTagExists){b=n(".tag",f.$container).filter(function(){return n(this).data("item")===p});f.options.onTagExists(i,b)}}}},remove:function(t,i,r){var u=this,f;if(u.objectItems&&(t="object"==typeof t?n.grep(u.itemsArray,function(n){return u.options.itemValue(n)==u.options.itemValue(t)}):n.grep(u.itemsArray,function(n){return u.options.itemValue(n)==t}),t=t[t.length-1]),t){if(f=n.Event("beforeItemRemove",{item:t,cancel:!1,options:r}),u.$element.trigger(f),f.cancel)return;n(".tag",u.$container).filter(function(){return n(this).data("item")===t}).remove();n("option",u.$element).filter(function(){return n(this).data("item")===t}).remove();-1!==n.inArray(t,u.itemsArray)&&u.itemsArray.splice(n.inArray(t,u.itemsArray),1)}i||u.pushVal(u.options.triggerChange);u.options.maxTags>u.itemsArray.length&&u.$container.removeClass("bootstrap-tagsinput-max");u.$element.trigger(n.Event("itemRemoved",{item:t,options:r}))},removeAll:function(){var t=this;for(n(".tag",t.$container).remove(),n("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal(t.options.triggerChange)},refresh:function(){var i=this;n(".tag",i.$container).each(function(){var r=n(this),u=r.data("item"),e=i.options.itemValue(u),o=i.options.itemText(u),s=i.options.tagClass(u),f;(r.attr("class",null),r.addClass("tag "+t(s)),r.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=t(o),i.isSelect)&&(f=n("option",i.$element).filter(function(){return n(this).data("item")===u}),f.attr("value",e))})},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=n.map(t.items(),function(n){return t.options.itemValue(n).toString()});t.$element.val(i,!0);t.options.triggerChange&&t.$element.trigger("change")},build:function(t){var i=this,h;if((i.options=n.extend({},e,t),i.objectItems&&(i.options.freeInput=!1),r(i.options,"itemValue"),r(i.options,"itemText"),u(i.options,"tagClass"),i.options.typeahead)&&(h=i.options.typeahead||{},u(h,"source"),i.$input.typeahead(n.extend({},h,{source:function(t,r){function f(n){for(var f,u=[],t=0;t<n.length;t++)f=i.options.itemText(n[t]),e[f]=n[t],u.push(f);r(u)}this.map={};var e=this.map,u=h.source(t);n.isFunction(u.success)?u.success(f):n.isFunction(u.then)?u.then(f):n.when(u).then(f)},updater:function(n){return i.add(this.map[n]),this.map[n]},matcher:function(n){return-1!==n.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(n){return n.sort()},highlighter:function(n){var t=new RegExp("("+this.query+")","gi");return n.replace(t,"<strong>$1<\/strong>")}}))),i.options.typeaheadjs){var l=null,o={},c=i.options.typeaheadjs;n.isArray(c)?(l=c[0],o=c[1]):o=c;i.$input.typeahead(l,o).on("typeahead:selected",n.proxy(function(n,t){o.valueKey?i.add(t[o.valueKey]):i.add(t);i.$input.typeahead("val","")},i))}i.$container.on("click",n.proxy(function(){i.$element.attr("disabled")||i.$input.removeAttr("disabled");i.$input.focus()},i));i.options.addOnBlur&&i.options.freeInput&&i.$input.on("focusout",n.proxy(function(){0===n(".typeahead, .twitter-typeahead",i.$container).length&&(i.add(i.$input.val()),i.$input.val(""))},i));i.$container.on({focusin:function(){i.$container.addClass(i.options.focusClass)},focusout:function(){i.$container.removeClass(i.options.focusClass)}});i.$container.on("keydown","input",n.proxy(function(t){var r=n(t.target),u=i.findInputWrapper(),e,o,s,h,c;if(i.$element.attr("disabled"))return void i.$input.attr("disabled","disabled");switch(t.which){case 8:0===f(r[0])&&(e=u.prev(),e.length&&i.remove(e.data("item")));break;case 46:0===f(r[0])&&(o=u.next(),o.length&&i.remove(o.data("item")));break;case 37:s=u.prev();0===r.val().length&&s[0]&&(s.before(u),r.focus());break;case 39:h=u.next();0===r.val().length&&h[0]&&(h.after(u),r.focus())}c=r.val().length;Math.ceil(c/5);r.attr("size",Math.max(this.inputSize,r.val().length))},i));i.$container.on("keypress","input",n.proxy(function(t){var r=n(t.target),u,f,e;if(i.$element.attr("disabled"))return void i.$input.attr("disabled","disabled");u=r.val();f=i.options.maxChars&&u.length>=i.options.maxChars;i.options.freeInput&&(s(t,i.options.confirmKeys)||f)&&(0!==u.length&&(i.add(f?u.substr(0,i.options.maxChars):u),r.val("")),i.options.cancelConfirmKeysOnEmpty===!1&&t.preventDefault());e=r.val().length;Math.ceil(e/5);r.attr("size",Math.max(this.inputSize,r.val().length))},i));i.$container.on("click","[data-role=remove]",n.proxy(function(t){i.$element.attr("disabled")||i.remove(n(t.target).closest(".tag").data("item"))},i));i.options.itemValue===e.itemValue&&("INPUT"===i.$element[0].tagName?i.add(i.$element.val()):n("option",i.$element).each(function(){i.add(n(this).attr("value"),!0)}))},destroy:function(){var n=this;n.$container.off("keypress","input");n.$container.off("click","[role=remove]");n.$container.remove();n.$element.removeData("tagsinput");n.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],i=this.$container[0];t&&t.parentNode!==i;)t=t.parentNode;return n(t)}};n.fn.tagsinput=function(t,r,u){var f=[];return this.each(function(){var e=n(this).data("tagsinput"),o;e?t||r?void 0!==e[t]&&(o=3===e[t].length&&void 0!==u?e[t](r,null,u):e[t](r),void 0!==o&&f.push(o)):f.push(e):(e=new i(this,t),n(this).data("tagsinput",e),f.push(e),"SELECT"===this.tagName&&n("option",n(this)).attr("selected","selected"),n(this).val(n(this).val()))}),"string"==typeof t?f.length>1?f:f[0]:f};n.fn.tagsinput.Constructor=i;o=n("<div />");n(function(){n("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery);!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof exports?module.exports=global.window&&global.window.$?n(global.window.$):function(t){if(!t.$&&!t.fn)throw new Error("Tokenfield requires a window object with jQuery or a jQuery instance");return n(t.$||t)}:n(jQuery,window)}(function(n,t){"use strict";var i=function(i,r){var e=this,o,s,y,u,c,b,l,a,k;this.$element=n(i);this.textDirection=this.$element.css("direction");this.options=n.extend(!0,{},n.fn.tokenfield.defaults,{tokens:this.$element.val()},this.$element.data(),r);this._delimiters="string"==typeof this.options.delimiter?[this.options.delimiter]:this.options.delimiter;this._triggerKeys=n.map(this._delimiters,function(n){return n.charCodeAt(0)});this._firstDelimiter=this._delimiters[0];o=n.inArray(" ",this._delimiters);s=n.inArray("-",this._delimiters);o>=0&&(this._delimiters[o]="\\s");s>=0&&(delete this._delimiters[s],this._delimiters.unshift("-"));y=["\\","$","[","{","^",".","|","?","*","+","(",")"];n.each(this._delimiters,function(t,i){var r=n.inArray(i,y);r>=0&&(e._delimiters[t]="\\"+i)});var h,p=t&&"function"==typeof t.getMatchedCSSRules?t.getMatchedCSSRules(i):null,w=i.style.width,d=this.$element.width();if(p&&n.each(p,function(n,t){t.style.width&&(h=t.style.width)}),u="rtl"===n("body").css("direction")?"right":"left",c={position:this.$element.css("position")},c[u]=this.$element.css(u),this.$element.data("original-styles",c).data("original-tabindex",this.$element.prop("tabindex")).css("position","absolute").css(u,"-10000px").prop("tabindex",-1),this.$wrapper=n('<div class="tokenfield form-control" />'),this.$element.hasClass("input-lg")&&this.$wrapper.addClass("input-lg"),this.$element.hasClass("input-sm")&&this.$wrapper.addClass("input-sm"),"rtl"===this.textDirection&&this.$wrapper.addClass("rtl"),b=this.$element.prop("id")||(new Date).getTime()+""+Math.floor(100*(1+Math.random())),this.$input=n('<input type="'+this.options.inputType+'" class="token-input" autocomplete="off" />').appendTo(this.$wrapper).prop("placeholder",this.$element.prop("placeholder")).prop("id",b+"-tokenfield").prop("tabindex",this.$element.data("original-tabindex")),l=n('label[for="'+this.$element.prop("id")+'"]'),(l.length&&l.prop("for",this.$input.prop("id")),this.$copyHelper=n('<input type="text" />').css("position","absolute").css(u,"-10000px").prop("tabindex",-1).prependTo(this.$wrapper),w?this.$wrapper.css("width",w):h?this.$wrapper.css("width",h):this.$element.parents(".form-inline").length&&this.$wrapper.width(d),(this.$element.prop("disabled")||this.$element.parents("fieldset[disabled]").length)&&this.disable(),this.$element.prop("readonly")&&this.readonly(),this.$mirror=n('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),this.$input.css("min-width",this.options.minWidth+"px"),n.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(n,t){e.$mirror[0].style[t]=e.$input.css(t)}),this.$mirror.appendTo("body"),this.$wrapper.insertBefore(this.$element),this.$element.prependTo(this.$wrapper),this.update(),this.setTokens(this.options.tokens,!1,!this.$element.val()&&this.options.tokens),this.listen(),n.isEmptyObject(this.options.autocomplete))||(a="rtl"===this.textDirection?"right":"left",k=n.extend({minLength:this.options.showAutocompleteOnFocus?0:null,position:{my:a+" top",at:a+" bottom",of:this.$wrapper}},this.options.autocomplete),this.$input.autocomplete(k)),!n.isEmptyObject(this.options.typeahead)){var f=this.options.typeahead,g={minLength:this.options.showAutocompleteOnFocus?0:null},v=n.isArray(f)?f:[f,f];v[0]=n.extend({},g,v[0]);this.$input.typeahead.apply(this.$input,v);this.typeahead=!0}},r;return i.prototype={constructor:i,createToken:function(t,i){var u=this,o,r,f,e;if((t="string"==typeof t?{value:t,label:t}:n.extend({},t),"undefined"==typeof i&&(i=!0),t.value=n.trim(t.value.toString()),t.label=t.label&&t.label.length?n.trim(t.label):t.value,!(!t.value.length||!t.label.length||t.label.length<=this.options.minLength||this.options.limit&&this.getTokens().length>=this.options.limit))&&(o=n.Event("tokenfield:createtoken",{attrs:t}),this.$element.trigger(o),o.attrs&&!o.isDefaultPrevented()))return r=n('<div class="token" />').append('<span class="token-label" />').append('<a href="#" class="close" tabindex="-1">&times;<\/a>').data("attrs",t),this.$input.hasClass("tt-input")?this.$input.parent().before(r):this.$input.before(r),this.$input.css("width",this.options.minWidth+"px"),f=r.find(".token-label"),e=r.find(".close"),this.maxTokenWidth||(this.maxTokenWidth=this.$wrapper.width()-e.outerWidth()-parseInt(e.css("margin-left"),10)-parseInt(e.css("margin-right"),10)-parseInt(r.css("border-left-width"),10)-parseInt(r.css("border-right-width"),10)-parseInt(r.css("padding-left"),10)-parseInt(r.css("padding-right"),10),parseInt(f.css("border-left-width"),10)-parseInt(f.css("border-right-width"),10)-parseInt(f.css("padding-left"),10)-parseInt(f.css("padding-right"),10),parseInt(f.css("margin-left"),10)-parseInt(f.css("margin-right"),10)),f.text(t.label).css("max-width",this.maxTokenWidth),r.on("mousedown",function(){return u._disabled||u._readonly?!1:(u.preventDeactivation=!0,void 0)}).on("click",function(n){return u._disabled||u._readonly?!1:(u.preventDeactivation=!1,n.ctrlKey||n.metaKey?(n.preventDefault(),u.toggle(r)):(u.activate(r,n.shiftKey,n.shiftKey),void 0))}).on("dblclick",function(){return u._disabled||u._readonly||!u.options.allowEditing?!1:(u.edit(r),void 0)}),e.on("click",n.proxy(this.remove,this)),this.$element.trigger(n.Event("tokenfield:createdtoken",{attrs:t,relatedTarget:r.get(0)})),i&&this.$element.val(this.getTokensList()).trigger(n.Event("change",{initiator:"tokenfield"})),this.update(),this.$element.get(0)},setTokens:function(t,i,r){if(t){i||this.$wrapper.find(".token").remove();"undefined"==typeof r&&(r=!0);"string"==typeof t&&(t=this._delimiters.length?t.split(new RegExp("["+this._delimiters.join("")+"]")):[t]);var u=this;return n.each(t,function(n,t){u.createToken(t,r)}),this.$element.get(0)}},getTokenData:function(t){var i=t.map(function(){var t=n(this);return t.data("attrs")}).get();return 1==i.length&&(i=i[0]),i},getTokens:function(t){var r=this,i=[],u=t?".active":"";return this.$wrapper.find(".token"+u).each(function(){i.push(r.getTokenData(n(this)))}),i},getTokensList:function(t,i,r){t=t||this._firstDelimiter;i="undefined"!=typeof i&&null!==i?i:this.options.beautify;var u=t+(i&&" "!==t?" ":"");return n.map(this.getTokens(r),function(n){return n.value}).join(u)},getInput:function(){return this.$input.val()},listen:function(){var i=this;this.$element.on("change",n.proxy(this.change,this));this.$wrapper.on("mousedown",n.proxy(this.focusInput,this));this.$input.on("focus",n.proxy(this.focus,this)).on("blur",n.proxy(this.blur,this)).on("paste",n.proxy(this.paste,this)).on("keydown",n.proxy(this.keydown,this)).on("keypress",n.proxy(this.keypress,this)).on("keyup",n.proxy(this.keyup,this));this.$copyHelper.on("focus",n.proxy(this.focus,this)).on("blur",n.proxy(this.blur,this)).on("keydown",n.proxy(this.keydown,this)).on("keyup",n.proxy(this.keyup,this));this.$input.on("keypress",n.proxy(this.update,this)).on("keyup",n.proxy(this.update,this));this.$input.on("autocompletecreate",function(){var t=n(this).data("ui-autocomplete").menu.element,r=i.$wrapper.outerWidth()-parseInt(t.css("border-left-width"),10)-parseInt(t.css("border-right-width"),10);t.css("min-width",r+"px")}).on("autocompleteselect",function(n,t){return i.createToken(t.item)&&(i.$input.val(""),i.$input.data("edit")&&i.unedit(!0)),!1}).on("typeahead:selected typeahead:autocompleted",function(n,t){i.createToken(t)&&(i.$input.typeahead("val",""),i.$input.data("edit")&&i.unedit(!0))});n(t).on("resize",n.proxy(this.update,this))},keydown:function(t){function r(n){if(i.$input.is(document.activeElement)){if(i.$input.val().length>0)return;n+="All";var r=i.$input.hasClass("tt-input")?i.$input.parent()[n](".token:first"):i.$input[n](".token:first");if(!r.length)return;i.preventInputFocus=!0;i.preventDeactivation=!0;i.activate(r);t.preventDefault()}else i[n](t.shiftKey),t.preventDefault()}function u(r){var u,f,e;if(t.shiftKey){if(i.$input.is(document.activeElement)){if(i.$input.val().length>0)return;if(u=i.$input.hasClass("tt-input")?i.$input.parent()[r+"All"](".token:first"):i.$input[r+"All"](".token:first"),!u.length)return;i.activate(u)}f="prev"===r?"next":"prev";e="prev"===r?"first":"last";i.$firstActiveToken[f+"All"](".token").each(function(){i.deactivate(n(this))});i.activate(i.$wrapper.find(".token:"+e),!0,!0);t.preventDefault()}}if(this.focused){var i=this;switch(t.keyCode){case 8:if(!this.$input.is(document.activeElement))break;this.lastInputValue=this.$input.val();break;case 37:r("rtl"===this.textDirection?"next":"prev");break;case 38:u("prev");break;case 39:r("rtl"===this.textDirection?"prev":"next");break;case 40:u("next");break;case 65:if(this.$input.val().length>0||!t.ctrlKey&&!t.metaKey)break;this.activateAll();t.preventDefault();break;case 9:case 13:if(this.$input.data("ui-autocomplete")&&this.$input.data("ui-autocomplete").menu.element.find("li:has(a.ui-state-focus), li.ui-state-focus").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-cursor").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-hint").val()&&this.$wrapper.find(".tt-hint").val().length)break;if(this.$input.is(document.activeElement)&&this.$input.val().length||this.$input.data("edit"))return this.createTokensFromInput(t,this.$input.data("edit"));if(13===t.keyCode){if(!this.$copyHelper.is(document.activeElement)||1!==this.$wrapper.find(".token.active").length)break;if(!i.options.allowEditing)break;this.edit(this.$wrapper.find(".token.active"))}}this.lastKeyDown=t.keyCode}},keypress:function(t){if(-1!==n.inArray(t.which,this._triggerKeys)&&this.$input.is(document.activeElement))return(this.$input.val()&&this.createTokensFromInput(t),!1)},keyup:function(n){if(this.preventInputFocus=!1,this.focused){switch(n.keyCode){case 8:if(this.$input.is(document.activeElement)){if(this.$input.val().length||this.lastInputValue.length&&8===this.lastKeyDown)break;this.preventDeactivation=!0;var t=this.$input.hasClass("tt-input")?this.$input.parent().prevAll(".token:first"):this.$input.prevAll(".token:first");if(!t.length)break;this.activate(t)}else this.remove(n);break;case 46:this.remove(n,"next")}this.lastKeyUp=n.keyCode}},focus:function(){this.focused=!0;this.$wrapper.addClass("focus");this.$input.is(document.activeElement)&&(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null,this.options.showAutocompleteOnFocus&&this.search())},blur:function(n){this.focused=!1;this.$wrapper.removeClass("focus");this.preventDeactivation||this.$element.is(document.activeElement)||(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null);!this.preventCreateTokens&&(this.$input.data("edit")&&!this.$input.is(document.activeElement)||this.options.createTokensOnBlur)&&this.createTokensFromInput(n);this.preventDeactivation=!1;this.preventCreateTokens=!1},paste:function(n){var t=this;t.options.allowPasting&&setTimeout(function(){t.createTokensFromInput(n)},1)},change:function(n){"tokenfield"!==n.initiator&&this.setTokens(this.$element.val())},createTokensFromInput:function(n,t){if(!(this.$input.val().length<this.options.minLength)){var i=this.getTokensList();return this.setTokens(this.$input.val(),!0),i==this.getTokensList()&&this.$input.val().length?!1:(this.$input.hasClass("tt-input")?this.$input.typeahead("val",""):this.$input.val(""),this.$input.data("edit")&&this.unedit(t),!1)}},next:function(n){var t,r,u,i;return n&&(t=this.$wrapper.find(".active:first"),r=t&&this.$firstActiveToken?t.index()<this.$firstActiveToken.index():!1,r)?this.deactivate(t):(u=this.$wrapper.find(".active:last"),i=u.nextAll(".token:first"),i.length?(this.activate(i,n),void 0):(this.$input.focus(),void 0))},prev:function(n){var i,r,u,t;return n&&(i=this.$wrapper.find(".active:last"),r=i&&this.$firstActiveToken?i.index()>this.$firstActiveToken.index():!1,r)?this.deactivate(i):(u=this.$wrapper.find(".active:first"),t=u.prevAll(".token:first"),t.length||(t=this.$wrapper.find(".token:first")),t.length||n?(this.activate(t,n),void 0):(this.$input.focus(),void 0))},activate:function(t,i,r,u){var u,i;if(t){if("undefined"==typeof u&&(u=!0),r&&(i=!0),this.$copyHelper.focus(),i||(this.$wrapper.find(".active").removeClass("active"),u?this.$firstActiveToken=t:delete this.$firstActiveToken),r&&this.$firstActiveToken){var f=this.$firstActiveToken.index()-2,e=t.index()-2,o=this;this.$wrapper.find(".token").slice(Math.min(f,e)+1,Math.max(f,e)).each(function(){o.activate(n(this),!0)})}t.addClass("active");this.$copyHelper.val(this.getTokensList(null,null,!0)).select()}},activateAll:function(){var t=this;this.$wrapper.find(".token").each(function(i){t.activate(n(this),0!==i,!1,!1)})},deactivate:function(n){n&&(n.removeClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},toggle:function(n){n&&(n.toggleClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},edit:function(t){var f,e;if(t){var i=t.data("attrs"),r={attrs:i,relatedTarget:t.get(0)},u=n.Event("tokenfield:edittoken",r);(this.$element.trigger(u),u.isDefaultPrevented())||(t.find(".token-label").text(i.value),f=t.outerWidth(),e=this.$input.hasClass("tt-input")?this.$input.parent():this.$input,t.replaceWith(e),this.preventCreateTokens=!0,this.$input.val(i.value).select().data("edit",!0).width(f),this.update(),this.$element.trigger(n.Event("tokenfield:editedtoken",r)))}},unedit:function(n){var i=this.$input.hasClass("tt-input")?this.$input.parent():this.$input,t;(i.appendTo(this.$wrapper),this.$input.data("edit",!1),this.$mirror.text(""),this.update(),n)&&(t=this,setTimeout(function(){t.$input.focus()},1))},remove:function(t,i){var r,i,e,u,f,o,s;this.$input.is(document.activeElement)||this._disabled||this._readonly||(r="click"===t.type?n(t.target).closest(".token"):this.$wrapper.find(".token.active"),"click"!==t.type&&(i||(i="prev"),(this[i](),"prev"===i)&&(e=0===r.first().prevAll(".token:first").length)),u={attrs:this.getTokenData(r),relatedTarget:r.get(0)},f=n.Event("tokenfield:removetoken",u),(this.$element.trigger(f),f.isDefaultPrevented())||(o=n.Event("tokenfield:removedtoken",u),s=n.Event("change",{initiator:"tokenfield"}),r.remove(),this.$element.val(this.getTokensList()).trigger(o).trigger(s),(!this.$wrapper.find(".token").length||"click"===t.type||e)&&this.$input.focus(),this.$input.css("width",this.options.minWidth+"px"),this.update(),t.preventDefault(),t.stopPropagation()))},update:function(){var n=this.$input.val(),u=parseInt(this.$input.css("padding-left"),10),f=parseInt(this.$input.css("padding-right"),10),r=u+f,t,i;if(this.$input.data("edit")){if(n||(n=this.$input.prop("placeholder")),n===this.$mirror.text())return;if(this.$mirror.text(n),t=this.$mirror.width()+10,t>this.$wrapper.width())return this.$input.width(this.$wrapper.width());this.$input.width(t)}else i="rtl"===this.textDirection?this.$input.offset().left+this.$input.outerWidth()-this.$wrapper.offset().left-parseInt(this.$wrapper.css("padding-left"),10)-r-1:this.$wrapper.offset().left+this.$wrapper.width()+parseInt(this.$wrapper.css("padding-left"),10)-this.$input.offset().left-r,isNaN(i)?this.$input.width("100%"):this.$input.width(i)},focusInput:function(t){if(!(n(t.target).closest(".token").length||n(t.target).closest(".token-input").length||n(t.target).closest(".tt-dropdown-menu").length)){var i=this;setTimeout(function(){i.$input.focus()},0)}},search:function(){this.$input.data("ui-autocomplete")&&this.$input.autocomplete("search")},disable:function(){this.setProperty("disabled",!0)},enable:function(){this.setProperty("disabled",!1)},readonly:function(){this.setProperty("readonly",!0)},writeable:function(){this.setProperty("readonly",!1)},setProperty:function(n,t){this["_"+n]=t;this.$input.prop(n,t);this.$element.prop(n,t);this.$wrapper[t?"addClass":"removeClass"](n)},destroy:function(){var t;return this.$element.val(this.getTokensList()),this.$element.css(this.$element.data("original-styles")),this.$element.prop("tabindex",this.$element.data("original-tabindex")),t=n('label[for="'+this.$input.prop("id")+'"]'),t.length&&t.prop("for",this.$element.prop("id")),this.$element.insertBefore(this.$wrapper),this.$element.removeData("original-styles").removeData("original-tabindex").removeData("bs.tokenfield"),this.$wrapper.remove(),this.$mirror.remove(),this.$element}},r=n.fn.tokenfield,n.fn.tokenfield=function(t,r){var u,f=[],e;return Array.prototype.push.apply(f,arguments),e=this.each(function(){var o=n(this),e=o.data("bs.tokenfield"),s="object"==typeof t&&t;"string"==typeof t&&e&&e[t]?(f.shift(),u=e[t].apply(e,f)):e||"string"==typeof t||r||(o.data("bs.tokenfield",e=new i(this,s)),o.trigger("tokenfield:initialize"))}),"undefined"!=typeof u?u:e},n.fn.tokenfield.defaults={minWidth:60,minLength:0,allowEditing:!0,allowPasting:!0,limit:0,autocomplete:{},typeahead:{},showAutocompleteOnFocus:!1,createTokensOnBlur:!1,delimiter:",",beautify:!0,inputType:"text"},n.fn.tokenfield.Constructor=i,n.fn.tokenfield.noConflict=function(){return n.fn.tokenfield=r,this},i})