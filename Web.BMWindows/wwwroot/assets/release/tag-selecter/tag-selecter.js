(function(n){n.fn.tagSelector=function(t){var i=this,u=this.selector,f,r;return i.selectedData=[],i.count=0,f=n(u).find("select"),r=n.extend({editUrl:null,dataUrl:null,addTagData:null},t),i.events=function(){var t=r.editUrl!=null?r.editUrl:"/article/tagEdit";n(u).find(".add-btn").unbind().click(function(){var e=n(u).find(".create-form");n(e).show();n(e).find(".btn-save-tag").unbind().click(function(){if(hasValue(n(e).find("input").val())){var o={name:n(e).find("input").val()};r.addTagData!=null&&(o=n.extend(o,r.addTagData));n.ajax({type:"POST",url:t,data:o,success:function(t){t!=null&&(i.selectedData.push({id:t.Id,text:t.Name}),f.select2("destroy"),f.append('<option selected="selected" value="'+t.Id+'">'+t.Name+"<\/option>"),i.initSelect());n(e).hide();n(e).find("input").val("")}})}else n(u).find("p").text("Nhập tên tag")});n(e).find(".btn-cancel-tag").unbind().click(function(){var t=n(u).find(".create-form");n(t).hide()})})},i.init=function(){var t=n(u).find('input[type="hidden"]').val();hasValue(t)&&(i.selectedData=n.parseJSON(t));n(i.selectedData).each(function(){f.append('<option selected="selected" value="'+this.id+'">'+(app.hasValue(this.text)?this.text:this.text_vn)+"<\/option>")});i.initSelect();i.events()},i.initSelect=function(){var t=r.dataUrl!=null?r.dataUrl:"/article/tagList";f.unbind().select2({ajax:{url:t,dataType:"json",delay:150,data:function(n){return{keyword:n.term,page:n.page,limit:5}},processResults:function(t,i){var r=[];return t.Many.length>0&&n(t.Many).each(function(){r.push({id:this.Id,text:this.Name})}),i.page=i.page||1,{results:r,pagination:{more:i.page*30<0}}}},minimumInputLength:1}).on("select2:select",function(n){var t=n.params.data;i.selectedData.push({id:t.id,text:t.text});f.select2("destroy");i.initSelect()})},i.init(),i}})(jQuery)